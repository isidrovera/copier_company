<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <data>
        <!-- Formato de papel simple -->
        <record id="paperformat_sticker_simple" model="report.paperformat">
            <field name="name">Sticker A4</field>
            <field name="format">A4</field>
            <field name="orientation">Portrait</field>
            <field name="margin_top">10</field>
            <field name="margin_bottom">10</field>
            <field name="margin_left">10</field>
            <field name="margin_right">10</field>
            <field name="header_line" eval="False"/>
            <field name="dpi">300</field>
        </record>

        <!-- Reporte simple -->
        <record id="action_report_sticker_simple" model="ir.actions.report">
            <field name="name">Sticker Corporativo</field>
            <field name="model">copier.company</field>
            <field name="report_type">qweb-pdf</field>
            <field name="report_name">copier_company.sticker_simple_template</field>
            <field name="report_file">copier_company.sticker_simple_template</field>
            <field name="print_report_name">'Sticker-%s' % (object.name.name if object.name else 'Sin-nombre')</field>
            <field name="binding_model_id" ref="model_copier_company"/>
            <field name="binding_type">report</field>
            <field name="paperformat_id" ref="paperformat_sticker_simple"/>
        </record>

        <!-- Template limpio -->
        <template id="sticker_simple_template">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="doc">
                    <div class="page">
                        
                        <!-- Generar QR si no existe -->
                        <t t-if="not doc.qr_code">
                            <t t-set="dummy" t-value="doc.generar_qr_code()"/>
                        </t>
                        
                        <!-- Contenedor del sticker 10x6cm -->
                        <div class="sticker-container">
                            
                            <!-- Header con logo -->
                            <div class="sticker-header">
                                <t t-set="company" t-value="request.env.company"/>
                                <t t-if="company and company.logo">
                                    <img t-att-src="'data:image/png;base64,%s' % company.logo.decode('utf-8')" 
                                         class="company-logo" alt="Logo"/>
                                </t>
                                <t t-else="">
                                    <div class="company-name">COPIER COMPANY</div>
                                </t>
                            </div>
                            
                            <!-- Contenido principal -->
                            <div class="sticker-content">
                                <!-- Lado izquierdo -->
                                <div class="left-content">
                                    <div class="title">ALQUILER DE FOTOCOPIADORAS</div>
                                    
                                    <div class="info-grid">
                                        <div class="info-item">
                                            <div class="info-label">MODELO</div>
                                            <div class="info-value">
                                                <t t-if="doc.name">
                                                    <t t-esc="doc.name.name"/>
                                                </t>
                                                <t t-else="">No especificado</t>
                                            </div>
                                        </div>
                                        
                                        <div class="info-item">
                                            <div class="info-label">SERIE</div>
                                            <div class="info-value">
                                                <t t-esc="doc.serie_id or 'N/A'"/>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="support-text">
                                        Para soporte tecnico escanea el QR o contactanos:
                                    </div>
                                    
                                    <div class="contact-info">
                                        <div>Email: info@copiercompanysac.com</div>
                                        <div>WhatsApp: 975399303</div>
                                        <div>Web: https://copiercompanysac.com</div>
                                    </div>
                                </div>
                                
                                <!-- Lado derecho - QR -->
                                <div class="right-content">
                                    <div class="qr-label">ESCANEAME</div>
                                    <div class="qr-container">
                                        <t t-if="doc.qr_code">
                                            <img t-att-src="'data:image/png;base64,%s' % doc.qr_code.decode('utf-8')" 
                                                 class="qr-image" alt="QR Code"/>
                                        </t>
                                        <t t-else="">
                                            <t t-set="qr_url" t-value="'https://copiercompanysac.com/ticket/' + str(doc.id)"/>
                                            <img t-att-src="'/report/qr?value=' + qr_url + '&amp;width=200&amp;height=200'" 
                                                 class="qr-image" alt="QR Code"/>
                                        </t>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Instrucciones de corte -->
                        <div class="cut-instructions">
                            Sticker: 10cm x 6cm - Cortar por la l√≠nea punteada
                        </div>
                        
                    </div>
                </t>
            </t>
        </template>
        
        <!-- CSS integrado -->
        <template id="sticker_styles" inherit_id="web.report_layout">
            <xpath expr="//head" position="inside">
                <style>
                    .page {
                        font-family: Arial, sans-serif;
                        padding: 2cm;
                        background: white;
                    }
                    
                    .sticker-container {
                        width: 10cm;
                        height: 6cm;
                        border: 2px dashed #666;
                        padding: 0.3cm;
                        background: white;
                        position: relative;
                        margin: 0 auto;
                    }
                    
                    .sticker-header {
                        text-align: center;
                        height: 2cm;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        margin-bottom: 0.2cm;
                    }
                    
                    .company-logo {
                        max-height: 2cm;
                        max-width: 8cm;
                        object-fit: contain;
                    }
                    
                    .company-name {
                        background: #2563eb;
                        color: white;
                        padding: 0.4cm 1.5cm;
                        border-radius: 8px;
                        font-weight: bold;
                        font-size: 18pt;
                        letter-spacing: 2px;
                    }
                    
                    .sticker-content {
                        display: flex;
                        height: calc(100% - 2.2cm);
                    }
                    
                    .left-content {
                        flex: 1;
                        padding-right: 0.2cm;
                    }
                    
                    .right-content {
                        width: 2.5cm;
                        text-align: center;
                    }
                    
                    .title {
                        background: #f8fafc;
                        border: 1px solid #e5e7eb;
                        border-radius: 4px;
                        padding: 0.15cm;
                        text-align: center;
                        font-size: 11pt;
                        font-weight: bold;
                        color: #1e40af;
                        text-transform: uppercase;
                        letter-spacing: 0.5px;
                        margin-bottom: 0.2cm;
                    }
                    
                    .info-grid {
                        display: flex;
                        gap: 0.1cm;
                        margin-bottom: 0.2cm;
                    }
                    
                    .info-item {
                        flex: 1;
                        background: #f8fafc;
                        border-left: 3px solid #2563eb;
                        padding: 0.1cm;
                        border-radius: 2px;
                    }
                    
                    .info-label {
                        font-size: 8pt;
                        font-weight: bold;
                        color: #1e40af;
                        text-transform: uppercase;
                    }
                    
                    .info-value {
                        font-size: 9pt;
                        color: #374151;
                        font-weight: 500;
                        line-height: 1.2;
                        margin-top: 0.05cm;
                    }
                    
                    .support-text {
                        background: #f0f9ff;
                        border-left: 3px solid #0ea5e9;
                        padding: 0.1cm;
                        border-radius: 2px;
                        font-size: 8pt;
                        color: #374151;
                        font-weight: 500;
                        text-align: center;
                        margin-bottom: 0.2cm;
                    }
                    
                    .contact-info {
                        background: #f8fafc;
                        border: 1px solid #e5e7eb;
                        border-radius: 4px;
                        padding: 0.1cm;
                        font-size: 8pt;
                        color: #374151;
                        line-height: 1.3;
                    }
                    
                    .qr-label {
                        font-size: 8pt;
                        font-weight: bold;
                        color: #0ea5e9;
                        text-transform: uppercase;
                        letter-spacing: 0.5px;
                        margin-bottom: 0.1cm;
                    }
                    
                    .qr-container {
                        width: 2.2cm;
                        height: 2.2cm;
                        border: 2px solid #e5e7eb;
                        border-radius: 6px;
                        background: white;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        padding: 0.1cm;
                        margin: 0 auto;
                    }
                    
                    .qr-image {
                        width: 2cm;
                        height: 2cm;
                        object-fit: contain;
                    }
                    
                    .cut-instructions {
                        margin-top: 1cm;
                        text-align: center;
                        font-size: 10pt;
                        color: #666;
                    }
                    
                    @media print {
                        .page {
                            padding: 2cm !important;
                        }
                        
                        .sticker-container {
                            border: 2px dashed #666 !important;
                        }
                        
                        * {
                            -webkit-print-color-adjust: exact !important;
                            color-adjust: exact !important;
                            print-color-adjust: exact !important;
                        }
                    }
                </style>
            </xpath>
        </template>
    </data>
</odoo>