<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <data>
        <!-- Formato de papel A4 sin dimensiones específicas -->
        <record id="paperformat_sticker" model="report.paperformat">
            <field name="name">Sticker en A4 - 10x6cm</field>
            <field name="format">A4</field>
            <field name="margin_top">20</field>
            <field name="margin_bottom">20</field>
            <field name="margin_left">20</field>
            <field name="margin_right">20</field>
            <field name="orientation">Portrait</field>
            <field name="header_line" eval="False"/>
            <field name="header_spacing">0</field>
            <field name="dpi">300</field>
        </record>

        <!-- Reporte -->
        <record id="action_report_sticker_corporativo" model="ir.actions.report">
            <field name="name">Sticker Corporativo</field>
            <field name="model">copier.company</field>
            <field name="report_type">qweb-pdf</field>
            <field name="report_name">copier_company.sticker_template</field>
            <field name="report_file">copier_company.sticker_template</field>
            <field name="print_report_name">'Sticker-%s' % (object.name.name if object.name else 'Sin-nombre')</field>
            <field name="binding_model_id" ref="model_copier_company"/>
            <field name="binding_type">report</field>
            <field name="paperformat_id" ref="paperformat_sticker"/>
        </record>

        <!-- Template profesional en A4 -->
        <template id="sticker_template">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="doc">
                    <!-- Página A4 con sticker centrado -->
                    <div class="page" style="width: 21cm; height: 29.7cm; margin: 0; padding: 2cm; font-family: 'Arial', 'Helvetica', sans-serif; background: white; display: flex; align-items: flex-start; justify-content: center;">
                        
                        <!-- Asegurar que el QR esté generado -->
                        <t t-if="not doc.qr_code">
                            <t t-set="dummy" t-value="doc.generar_qr_code()"/>
                        </t>
                        
                        <!-- Sticker exacto de 10x6cm -->
                        <div style="width: 10cm; height: 6cm; border: 2px dashed #666666; box-sizing: border-box; padding: 0.3cm; position: relative; background: white; margin: 0;">
                            
                            <!-- Logo de la empresa centrado en la parte superior (3x más grande) -->
                            <div style="text-align: center; margin-bottom: 0.2cm; height: 2cm; display: flex; align-items: center; justify-content: center;">
                                <t t-set="company" t-value="request.env.company"/>
                                <t t-if="company and company.logo">
                                    <img t-att-src="'data:image/png;base64,%s' % company.logo.decode('utf-8')" 
                                         style="max-height: 2cm; max-width: 8cm; object-fit: contain;" 
                                         alt="Logo Empresa"/>
                                </t>
                                <t t-else="">
                                    <div style="background: #2563eb; color: white; padding: 0.4cm 1.5cm; border-radius: 8px; font-weight: bold; font-size: 18pt; letter-spacing: 2px;">
                                        COPIER COMPANY
                                    </div>
                                </t>
                            </div>
                            
                            <!-- Layout principal -->
                            <table style="width: 100%; height: calc(100% - 2.2cm); border-collapse: collapse; font-size: 10pt;">
                                <tr>
                                    <!-- Contenido izquierdo -->
                                    <td style="width: 65%; vertical-align: top; padding-right: 0.2cm;">
                                        
                                        <!-- Título -->
                                        <div style="text-align: center; background: #f8fafc; border: 1px solid #e5e7eb; border-radius: 4px; padding: 0.15cm; margin-bottom: 0.2cm;">
                                            <div style="font-size: 11pt; font-weight: bold; color: #1e40af; text-transform: uppercase; letter-spacing: 0.5px;">
                                                ALQUILER DE FOTOCOPIADORAS
                                            </div>
                                        </div>
                                        
                                        <!-- Información del equipo -->
                                        <table style="width: 100%; border-collapse: collapse; margin-bottom: 0.2cm;">
                                            <tr>
                                                <td style="width: 50%; padding: 0.1cm; vertical-align: top;">
                                                    <div style="background: #f8fafc; border-left: 3px solid #2563eb; padding: 0.1cm; border-radius: 2px;">
                                                        <div style="font-size: 8pt; font-weight: bold; color: #1e40af; text-transform: uppercase;">MODELO</div>
                                                        <div style="font-size: 9pt; color: #374151; font-weight: 500; line-height: 1.2; margin-top: 0.05cm;">
                                                            <t t-if="doc.name">
                                                                <t t-esc="doc.name.name"/>
                                                            </t>
                                                            <t t-else="">No especificado</t>
                                                        </div>
                                                    </div>
                                                </td>
                                                <td style="width: 50%; padding: 0.1cm; vertical-align: top;">
                                                    <div style="background: #f8fafc; border-left: 3px solid #2563eb; padding: 0.1cm; border-radius: 2px;">
                                                        <div style="font-size: 8pt; font-weight: bold; color: #1e40af; text-transform: uppercase;">SERIE</div>
                                                        <div style="font-size: 9pt; color: #374151; font-weight: 500; line-height: 1.2; margin-top: 0.05cm;">
                                                            <t t-esc="doc.serie_id or 'N/A'"/>
                                                        </div>
                                                    </div>
                                                </td>
                                            </tr>
                                        </table>
                                        
                                        <!-- Texto de soporte -->
                                        <div style="background: #f0f9ff; border-left: 3px solid #0ea5e9; padding: 0.1cm; border-radius: 2px; margin-bottom: 0.2cm;">
                                            <div style="font-size: 8pt; color: #374151; font-weight: 500; text-align: center;">
                                                Para soporte tecnico, escanea el QR o contactanos:
                                            </div>
                                        </div>
                                        
                                        <!-- Información de contacto -->
                                        <div style="background: #f8fafc; border: 1px solid #e5e7eb; border-radius: 4px; padding: 0.1cm;">
                                            <div style="font-size: 8pt; color: #374151; line-height: 1.3;">
                                                <div style="margin-bottom: 0.05cm;">
                                                    <span style="font-weight: bold; color: #1e40af;">Email:</span> info@copiercompanysac.com
                                                </div>
                                                <div style="margin-bottom: 0.05cm;">
                                                    <span style="font-weight: bold; color: #1e40af;">WhatsApp:</span> 975399303
                                                </div>
                                                <div>
                                                    <span style="font-weight: bold; color: #1e40af;">Web:</span> https://copiercompanysac.com
                                                </div>
                                            </div>
                                        </div>
                                    </td>
                                    
                                    <!-- QR Code -->
                                    <td style="width: 35%; text-align: center; vertical-align: middle; padding-left: 0.2cm;">
                                        <div style="text-align: center;">
                                            <div style="font-size: 8pt; font-weight: bold; color: #0ea5e9; margin-bottom: 0.1cm; text-transform: uppercase; letter-spacing: 0.5px;">
                                                ESCANEAME
                                            </div>
                                            <div style="width: 2.2cm; height: 2.2cm; border: 2px solid #e5e7eb; border-radius: 6px; margin: 0 auto; background: white; display: flex; align-items: center; justify-content: center; padding: 0.1cm; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                                                <t t-if="doc.qr_code">
                                                    <img t-att-src="'data:image/png;base64,%s' % doc.qr_code.decode('utf-8')" 
                                                         style="width: 2cm; height: 2cm; object-fit: contain;" 
                                                         alt="QR Code"/>
                                                </t>
                                                <t t-else="">
                                                    <!-- Fallback QR de alta calidad -->
                                                    <t t-set="qr_url" t-value="'https://copiercompanysac.com/ticket/' + str(doc.id)"/>
                                                    <img t-att-src="'/report/qr?value=' + qr_url + '&amp;width=200&amp;height=200&amp;error_correction=H'" 
                                                         style="width: 2cm; height: 2cm; object-fit: contain;" 
                                                         alt="QR Code"/>
                                                </t>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                        
                        <!-- Información adicional fuera del sticker (opcional) -->
                        <div style="position: absolute; top: 8cm; left: 2cm; font-size: 10pt; color: #666;">
                            <div>Sticker: 10cm x 6cm</div>
                            <div>Cortar por la línea punteada</div>
                        </div>
                        
                        <style>
                            @page {
                                size: A4;
                                margin: 2cm;
                            }
                            
                            @media print {
                                .page {
                                    margin: 0 !important;
                                    padding: 2cm !important;
                                    page-break-after: always;
                                    width: 21cm !important;
                                    height: 29.7cm !important;
                                }
                                
                                * {
                                    -webkit-print-color-adjust: exact !important;
                                    color-adjust: exact !important;
                                    print-color-adjust: exact !important;
                                }
                                
                                /* Asegurar que el borde punteado se imprima */
                                div[style*="dashed"] {
                                    border: 2px dashed #666666 !important;
                                }
                            }
                            
                            /* Mejoras para la visualización */
                            body {
                                font-family: 'Arial', 'Helvetica', sans-serif !important;
                                background: white;
                            }
                            
                            /* Asegurar alta calidad en imágenes */
                            img {
                                image-rendering: -webkit-optimize-contrast;
                                image-rendering: crisp-edges;
                                image-rendering: pixelated;
                            }
                        </style>
                    </div>
                </t>
            </t>
        </template>
    </data>
</odoo>