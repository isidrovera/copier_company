<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <data>
        <record id="action_report_report_cotizacion_alquiler" model="ir.actions.report">
            <field name="name">Propuesta Comercial de Alquiler</field>
            <field name="model">copier.company</field>
            <field name="report_type">qweb-pdf</field>
            <field name="report_name">copier_company.cotizacion_view</field>
            <field name="report_file">copier_company.cotizacion_view</field>
            <field name="print_report_name">'Propuesta Comercial - %s' % object.secuencia</field>
            <field name="binding_model_id" ref="model_copier_company"/>
            <field name="binding_type">report</field>
        </record>

         <template id="cotizacion_view">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="doc">
                    <t t-call="web.external_layout">
                        <div class="page">
                            <style>
                                :root {
                                    --primary: #2563eb;
                                    --secondary: #475569;
                                    --accent: #0891b2;
                                    --success: #059669;
                                    --warning: #d97706;
                                    --background: #f8fafc;
                                    --text: #1e293b;
                                    --border: #e2e8f0;
                                }

                                body {
                                    font-family: 'Roboto', sans-serif;
                                    color: var(--text);
                                    line-height: 1.6;
                                }

                                .header-section {
                                    display: flex;
                                    justify-content: space-between;
                                    align-items: center;
                                    margin-bottom: 2rem;
                                    padding: 1rem;
                                    background: var(--background);
                                    border-radius: 8px;
                                }

                                .section-title {
                                    background: var(--primary);
                                    color: white;
                                    padding: 0.75rem 1rem;
                                    border-radius: 6px;
                                    margin: 1.5rem 0 1rem;
                                    font-size: 1.25rem;
                                    font-weight: 600;
                                }

                                .info-table {
                                    width: 100%;
                                    border-collapse: separate;
                                    border-spacing: 0;
                                    margin: 1rem 0;
                                    border-radius: 8px;
                                    overflow: hidden;
                                    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
                                }

                                .info-table th, .info-table td {
                                    padding: 0.75rem 1rem;
                                    border: 1px solid var(--border);
                                }

                                .info-table th {
                                    background: var(--accent);
                                    color: white;
                                    font-weight: 600;
                                }

                                .image-container {
                                    text-align: center;
                                    margin: 2rem 0;
                                }

                                .image-container img {
                                    max-width: 400px;
                                    border-radius: 8px;
                                    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
                                }

                                .specs-section {
                                    background: var(--background);
                                    padding: 1rem;
                                    border-radius: 8px;
                                    margin: 1rem 0;
                                }

                                .conditions-list {
                                    list-style: none;
                                    padding-left: 1rem;
                                }

                                .conditions-list li {
                                    margin-bottom: 0.5rem;
                                    position: relative;
                                }

                                .conditions-list li:before {
                                    content: "•";
                                    position: absolute;
                                    left: -1rem;
                                    color: var(--primary);
                                }
                            </style>
                            <!-- Contenido del documento -->
                            <div class="header-section">
                                <img t-att-src="'/web/binary/company_logo'" class="company-logo"/>
                                <div class="quote-info">
                                    <p><t t-esc="doc.create_date.strftime('%A, %d de %B de %Y')"/></p>
                                </div>
                            </div>

                            <!-- Introducción -->
                            <div style="margin-bottom: 2rem;">
                                <p>Presente. -</p>
                                <p><strong>Atención:</strong> <t t-esc="doc.cliente_id.name"/></p>
                                <p><strong>Asunto:</strong> Alquiler de fotocopiadora multifuncional formato A4.</p>
                                <p>Estimados Señores,</p>
                                <p>En respuesta a su solicitud, nos complace presentarles nuestra COTIZACIÓN para el servicio de alquiler del siguiente equipo multifuncional:</p>
                                <p style="margin-left: 1rem;"><strong>1- <t t-esc="doc.name.name"/></strong></p>
                            </div>

                            <!-- Imagen del Equipo -->
                            <div class="image-container">
                                <t t-if="doc.imagen_id">
                                    <img t-att-src="'data:image/png;base64,%s' % doc.imagen_id.decode('utf-8')"/>
                                </t>
                            </div>

                            <!-- Especificaciones -->
                            <div class="section-title">Especificaciones del Equipo</div>
                            <div class="specs-section">
                                <t t-raw="doc.especificaciones_id"/>
                            </div>

                            <!-- Detalles Financieros -->
                            <div class="section-title">Detalles Financieros</div>
                            <table class="info-table">
                                <tr>
                                    <th>Fecha de Inicio del Alquiler</th>
                                    <td><t t-esc="doc.fecha_inicio_alquiler"/></td>
                                </tr>
                                <tr>
                                    <th>Fecha de Fin del Alquiler</th>
                                    <td><t t-esc="doc.fecha_fin_alquiler"/></td>
                                </tr>
                                <tr>
                                    <th>Moneda</th>
                                    <td><t t-esc="doc.currency_id.name"/></td>
                                </tr>
                                <tr>
                                    <th>Volumen mensual Copias/Impresiones B/N</th>
                                    <td><t t-esc="doc.volumen_mensual_bn"/></td>
                                </tr>
                                <tr>
                                    <th>Costo por Copia/Impresión B/N</th>
                                    <td>S/. <t t-esc="doc.costo_copia_bn"/> (no incluido IGV)</td>
                                </tr>
                                <tr>
                                    <th>Renta Mensual (B/N) incluido IGV</th>
                                    <td>S/. <t t-esc="doc.renta_mensual_bn"/></td>
                                </tr>
                                <tr>
                                    <th>Costo de copia excedente B/N</th>
                                    <td>S/. <t t-esc="doc.costo_copia_bn"/> (no incluido IGV)</td>
                                </tr>
                                <tr>
                                    <th>Volumen mensual Copias/Impresiones Color</th>
                                    <td><t t-esc="doc.volumen_mensual_color"/></td>
                                </tr>
                                <tr>
                                    <th>Costo por Copia/Impresión Color</th>
                                    <td>S/. <t t-esc="doc.costo_copia_color"/> (no incluido IGV)</td>
                                </tr>
                                <tr>
                                    <th>Renta Mensual (Color) incluido IGV</th>
                                    <td>S/. <t t-esc="doc.renta_mensual_color"/></td>
                                </tr>
                                <tr>
                                    <th>Costo de copia excedente Color</th>
                                    <td>S/. <t t-esc="doc.costo_copia_color"/> (no incluido IGV)</td>
                                </tr>
                                <tr>
                                    <th>Costo de scanner</th>
                                    <td>Gratis</td>
                                </tr>
                                <tr>
                                    <th>Disponibilidad</th>
                                    <td>5 Días presentando orden de compra</td>
                                </tr>
                                <tr>
                                    <th>IGV (%)</th>
                                    <td><t t-esc="doc.igv"/></td>
                                </tr>
                                <tr>
                                    <th>Descuento (%)</th>
                                    <td><t t-esc="doc.descuento"/></td>
                                </tr>
                                <tr style="background-color: var(--primary); color: white;">
                                    <th>Total a Facturar Mensual</th>
                                    <td>S/. <t t-esc="doc.total_facturar_mensual"/></td>
                                </tr>
                            </table>

                            <!-- Información Adicional -->
                            <div class="section-title">Información Adicional</div>
                            <ul class="conditions-list">
                                <li>Las tarifas en nuevos soles incluyen el impuesto General a las ventas (18%).</li>
                                <li>La facturación se realizará en nuevos soles.</li>
                                <li>Incluye instalación y capacitación.</li>
                                <li>Incluye renovación de maquinaria, insumos, repuestos y servicio técnico.</li>
                            </ul>

                            <!-- Condiciones Comerciales -->
                            <div class="section-title">Condiciones Comerciales</div>
                            <ul class="conditions-list">
                                <li>Los pagos pueden efectuarse en efectivo o depósito a:</li>
                                <li>Cuenta corriente soles BCP, 191-2334609-0-07 CCI: 002-19100233460900751</li>
                                <li>Cuenta de detracción: Banco de la Nación 00802007582</li>
                                <li>Firma del contrato Marco de Alquiler por 12 meses mínimo.</li>
                            </ul>

                            <!-- Condiciones de Alquiler -->
                            <div class="section-title">Condiciones de Alquiler</div>
                            <ul class="conditions-list">
                                <li>Los equipos se alquilan sin papel.</li>
                                <li>El periodo de alquiler se inicia con la entrega del equipo y finaliza con la recepción de este.</li>
                                <li>El equipo debe ser devuelto en las mismas condiciones en que fue entregado, sin más deterioro que el producido por el uso normal. En caso de presentarse cualquier daño, el cliente se hará responsable por el costo de las reparaciones según los cargos por daños vigentes a la devolución.</li>
                                <li>La inspección, mantenimiento, repuestos y consumibles del equipo son de exclusiva responsabilidad del ARRENDADOR.</li>
                                <li>Programa de mantenimiento cada 2 meses, mantenimiento preventivo.</li>
                            </ul>

                            <!-- Cierre -->
                            <div style="margin-top: 2rem; margin-bottom: 2rem;">
                                <p>Sin otro particular, nos ponemos a su disposición para atender sus consultas o requerimientos.</p>
                                <p style="margin-top: 1.5rem;">Atentamente,</p>
                                <div style="margin-top: 3rem;">
                                    <p>____________________</p>
                                    <p><t t-esc="user.name"/></p>
                                    <p>Ejecutivo Comercial</p>
                                </div>
                            </div>
                        </div>
                    </t>
                </t>
            </t>
        </template>
    </data>
</odoo>