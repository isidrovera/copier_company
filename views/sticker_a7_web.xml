<?xml version="1.0" encoding="UTF-8"?>
<odoo>
  <template id="sticker_a7_web_template">

    <t t-call="web.html_container">
      <t t-call="web.basic_layout">

        <style>
        /* Página A4 */
        @page {
            size: A4;
            margin: 5mm;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
        }

        /* Grilla 2 columnas x 4 filas = 8 stickers por hoja */
        .sheet {
            display: grid;
            grid-template-columns: repeat(2, 105mm);
            grid-template-rows: repeat(4, 74mm);
            gap: 6mm;
            justify-content: center;
        }

        /* Sticker A7 horizontal (105 x 74 mm) */
        .sticker {
            width: 105mm;
            height: 74mm;
            border: 1px solid #999;
            padding: 4mm;
            box-sizing: border-box;
            position: relative;
            background: #f9f9f4;
        }

        /* Encabezado */
        .logo {
            color: #d40000;
            font-weight: bold;
            font-size: 16px;
        }

        .sublogo {
            font-size: 9px;
            margin-bottom: 3px;
        }

        /* Bloque QR */
        .scan {
            position: absolute;
            top: 4mm;
            right: 4mm;
            border: 2px solid #d40000;
            padding: 2mm;
            text-align: center;
        }

        .scan-title {
            background: #d40000;
            color: white;
            font-size: 8px;
            padding: 2px;
            margin-bottom: 2px;
        }

        .qr {
            width: 32mm;
            height: 32mm;
        }

        /* Texto */
        .text {
            margin-top: 4mm;
            font-size: 9px;
        }

        .serial {
            margin-top: 3mm;
            font-size: 10px;
            font-weight: bold;
        }

        .contact {
            font-size: 9px;
        }

        /* Código de barras simulado */
        .barcode {
            margin-top: 4mm;
            height: 12mm;
            background: repeating-linear-gradient(
                90deg,
                #000 0px,
                #000 2px,
                #fff 2px,
                #fff 4px
            );
        }

        /* Colores correctos al imprimir */
        @media print {
            * {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }
        }
        </style>

        <div class="sheet">

          <!-- Recorremos los equipos seleccionados -->
          <t t-foreach="docs" t-as="doc">

            <!-- Generar QR si no existe -->
            <t t-if="not doc.qr_code">
              <t t-set="dummy" t-value="doc.generar_qr_code()" />
            </t>

            <div class="sticker">

              <!-- Logo -->
              <div class="logo">Canon</div>
              <div class="sublogo">CANON SOLUTIONS AMERICA</div>

              <!-- QR -->
              <div class="scan">
                <div class="scan-title">SCAN ME</div>
                <t t-if="doc.qr_code">
                  <img t-att-src="'data:image/png;base64,%s' % doc.qr_code.decode('utf-8')" class="qr"/>
                </t>
              </div>

              <!-- Texto -->
              <div class="text">
                For all your service needs,<br/>
                please scan the QR code.
              </div>

              <!-- Datos del equipo -->
              <div class="serial">
                Modelo:
                <t t-esc="doc.name.name if doc.name else 'N/D'"/>
              </div>

              <div class="serial">
                Serie:
                <t t-esc="doc.serie_id or 'N/D'"/>
              </div>

              <!-- Contacto -->
              <div class="contact">info@copiercompanysac.com</div>
              <div class="contact">+51 975 399 303</div>

              <!-- Código de barras -->
              <div class="barcode"></div>

            </div>

          </t>

        </div>

      </t>
    </t>

  </template>
</odoo>
