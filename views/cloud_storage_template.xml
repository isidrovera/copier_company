<odoo>
    <template id="cloud_storage_template" name="Cloud Storage">
        <t t-call="website.layout">
            <style>
    .cloud-storage-search {
        margin: 20px auto;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-wrap: wrap; /* Permite que los elementos se envuelvan en la siguiente línea en pantallas pequeñas */
    }
    .cloud-storage-search .cloud-search-input {
        flex-grow: 1; /* Permite que el input crezca para llenar el espacio disponible */
        margin-right: 10px;
        min-width: 150px; /* Establece un ancho mínimo para el input */
    }
    .cloud-storage-content .file-dir-entry,
    .search-results-content .search-result-entry {
        display: flex;
        align-items: center;
        margin-bottom: 5px;
        flex-wrap: wrap; /* Permite envolver el contenido en pantallas pequeñas */
    }
    .cloud-storage-content .file-dir-entry i,
    .search-results-content .search-result-entry i {
        margin-right: 10px;
    }
    .cloud-storage-content .file-dir-entry .download-btn,
    .search-results-content .search-result-entry .download-btn {
        margin-left: auto;
    }

    /* Media Query para pantallas menores a 600px */
    @media (max-width: 600px) {
        .cloud-storage-search {
            flex-direction: column; /* Cambia la disposición a vertical */
        }
        .cloud-storage-search .cloud-search-input,
        .cloud-storage-search button,
        .cloud-storage-search a.btn {
            width: 100%; /* Hace que los elementos ocupen todo el ancho disponible */
            margin-right: 0; /* Remueve el margen derecho */
            margin-bottom: 10px; /* Agrega margen inferior para separarlos */
        }
        .cloud-storage-content .file-dir-entry,
        .search-results-content .search-result-entry {
            flex-direction: column; /* Cambia la disposición a vertical */
        }
        .cloud-storage-content .file-dir-entry .download-btn,
        .search-results-content .search-result-entry .download-btn {
            margin-left: 0; /* Remueve el margen izquierdo */
        }
    }
</style>
            <div id="cloud_storage_wrapper" class="oe_structure">
                <div class="cloud-storage-search">
                    <form method="get" action="/cloud/storage/search">
                        <input type="text" name="query" class="cloud-search-input" placeholder="Buscar carpeta o archivo..." t-att-value="request.params.get('query', '')"/>
                        <button type="submit" class="btn btn-primary">Buscar</button>
                        <!-- Botón para limpiar el campo de búsqueda y refrescar la página -->
                        <a href="/cloud/storage" class="btn btn-secondary">Limpiar</a>
                    </form>
                </div>
                <!-- Navegación hacia atrás -->
                <t t-if="current_path">
                    <div class="cloud-storage-nav">
                        <!-- Botón para ir a la raíz -->
                        <a t-if="current_path" href="/cloud/storage" class="btn btn-secondary">&#8592; Raíz</a>
                        <!-- Botón para ir al directorio anterior -->
                        <a t-if="current_path" t-att-href="'/cloud/storage/' + '/'.join(current_path.split('/')[:-1])" class="btn btn-secondary">&#8592; Atrás</a>
                    </div>
                </t>
                <div class="cloud-storage-content">
                    <t t-foreach="files_dirs" t-as="file_dir">
                        <div class="file-dir-entry">
                            <t t-if="file_dir['is_dir']">
                                <i class="fa fa-folder"></i>
                                <a t-att-href="'/cloud/storage/' + file_dir['path']">
                                    <t t-esc="file_dir['name']"/>
                                </a>
                            </t>
                            <t t-else="">
                                <!-- Utiliza la función get_icon_class para obtener el ícono adecuado según la extensión del archivo -->
                                <i t-att-class="'fa ' + get_icon_class(file_dir['name'])"></i>
                                <span t-esc="file_dir['name']"/>
                                <a t-att-href="'/cloud/storage/download/' + file_dir['path']" class="btn btn-secondary btn-sm download-btn">Descargar</a>
                            </t>
                        </div>
                    </t>
                </div>

            </div>
        </t>
    </template>

    <template id="cloud_storage_search_template" name="Cloud Storage Search Results">
        <t t-call="website.layout">
            <div id="search_results_wrapper" class="oe_structure">
                <!-- Botón para volver a la vista principal de almacenamiento -->
                <div class="cloud-storage-nav">
                    <a href="/cloud/storage" class="btn btn-secondary">&#8592; Volver</a>
                </div>
                <h3>Resultados de búsqueda para "<t t-esc="query"/>
                </h3>
                <div class="search-results-content">
                    <t t-foreach="search_results" t-as="result">
                        <div class="search-result-entry">
                            <i class="fa fa-file"></i>
                            <span t-esc="result"/>
                            <a t-att-href="'/cloud/storage/download/' + result" class="btn btn-secondary btn-sm download-btn">Descargar</a>
                        </div>
                    </t>
                </div>
            </div>
        </t>
    </template>
</odoo>
