<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <template id="pdf_view_template" name="PDF View">
        <t t-call="website.layout">
            <div class="container mt-5">
                <div class="row">
                    <div class="col-12">
                        <h1>Vista de PDF</h1>
                        <div>
                            <canvas id="pdf-canvas" width="100%"></canvas>
                        </div>
                    </div>
                </div>
            </div>
            <script src="/copier_company/static/src/js/pdf.js"></script>
            <script src="/copier_company/static/src/js/pdf.worker.js"></script>
            <script type="text/javascript">
                document.addEventListener('DOMContentLoaded', function() {
                    var pdfUrl = "<t t-esc='pdf_url'/>";

                    if (pdfUrl) {
                        var loadingTask = pdfjsLib.getDocument(pdfUrl);
                        loadingTask.promise.then(function(pdf) {
                            pdf.getPage(1).then(function(page) {
                                var scale = 1.5;
                                var viewport = page.getViewport({ scale: scale });
                                var canvas = document.getElementById('pdf-canvas');
                                var context = canvas.getContext('2d');
                                canvas.height = viewport.height;
                                canvas.width = viewport.width;
                                var renderContext = {
                                    canvasContext: context,
                                    viewport: viewport
                                };
                                page.render(renderContext);
                            });
                        }).catch(function(error) {
                            console.error('Error loading PDF:', error);
                        });
                    } else {
                        console.error('No PDF URL provided');
                    }
                });
            </script>
        </t>
    </template>
</odoo>
