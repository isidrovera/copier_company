<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <data>
    <!-- P谩gina de Servicios (mejorada con modales y sin solaparse con el chat) -->
    <template id="copier_services_modern" name="Servicios">
      <t t-call="website.layout">
        <div id="wrap">
          <style>
            @import url('https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css');
            .services-hero-bg{background:linear-gradient(135deg,#198754 0%,#20c997 100%);min-height:60vh}
            .service-card-hover:hover{transform:translateY(-5px);transition:all .3s ease}
            .floating-animation{animation:float 3s ease-in-out infinite}
            @keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-10px)}}
            .pricing-badge{background:linear-gradient(45deg,#ffc107,#fd7e14);color:#000;font-weight:700}
            .service-icon{width:80px;height:80px;background:linear-gradient(135deg,#0d6efd,#6610f2)}
            /* Evitar solape con el chat de Odoo (abajo-derecha) */
            .cc-float-right{position:fixed;right:16px;bottom:96px;z-index:1049}
            .cc-float-left{position:fixed;left:16px;bottom:96px;z-index:1049}
            @media (max-width: 576px){
              .cc-float-right{bottom:84px;right:12px}
              .cc-float-left{bottom:84px;left:12px}
            }
          </style>

          <!-- HERO -->
          <section class="position-relative overflow-hidden text-white"
            style="background: linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.4)), url('/copier_company/static/img/office-hero.png'); background-size: cover; background-position: center; min-height: 70vh;">
            <div class="container position-relative" style="z-index:2;">
              <div class="row min-vh-70 align-items-center py-5">
                <div class="col-lg-7">
                  <h1 class="display-3 fw-bold mb-4">Soluciones <span class="text-warning">Completas</span><br/>de Impresi贸n Empresarial</h1>
                  <p class="fs-4 mb-4 opacity-90"><strong>Desde alquiler sin inversi贸n inicial hasta soporte t茅cnico 24/7.</strong><br/>Transformamos la productividad de tu oficina con las mejores marcas del mercado.</p>
                  <div class="row g-3 mb-4">
                    <div class="col-md-6">
                      <div class="d-flex align-items-center bg-white bg-opacity-15 rounded-3 p-3">
                        <i class="bi bi-shield-check text-success fs-1 me-3"></i>
                        <div><h5 class="mb-1">Garant铆a Total</h5><small class="opacity-75">Mantenimiento incluido</small></div>
                      </div>
                    </div>
                    <div class="col-md-6">
                      <div class="d-flex align-items-center bg-white bg-opacity-15 rounded-3 p-3">
                        <i class="bi bi-clock text-warning fs-1 me-3"></i>
                        <div><h5 class="mb-1">Instalaci贸n 24H</h5><small class="opacity-75">Listo para trabajar</small></div>
                      </div>
                    </div>
                  </div>
                  <div class="row g-2 mb-5">
                    <div class="col-3 text-center"><h2 class="display-6 fw-bold text-warning mb-0">500+</h2><small class="opacity-75">Empresas</small></div>
                    <div class="col-3 text-center"><h2 class="display-6 fw-bold text-success mb-0">15</h2><small class="opacity-75">A帽os</small></div>
                    <div class="col-3 text-center"><h2 class="display-6 fw-bold text-info mb-0">4H</h2><small class="opacity-75">Respuesta</small></div>
                    <div class="col-3 text-center"><h2 class="display-6 fw-bold text-primary mb-0">24/7</h2><small class="opacity-75">Soporte</small></div>
                  </div>
                  <div class="d-flex flex-column flex-sm-row gap-3">
                    <a href="/cotizacion/form" class="btn btn-warning btn-lg px-4 py-3 fw-bold"><i class="bi bi-calculator me-2"></i>Solicitar Cotizaci贸n</a>
                    <a href="#servicios" class="btn btn-outline-light btn-lg px-4 py-3"><i class="bi bi-arrow-down me-2"></i>Ver Servicios</a>
                  </div>
                </div>
              </div>
            </div>
          </section>

          <!-- SERVICIOS PRINCIPALES -->
          <section id="servicios" class="py-5">
            <div class="container">
              <div class="text-center mb-5">
                <span class="badge bg-success fs-6 px-3 py-2 rounded-pill mb-3">Servicios Principales</span>
                <h2 class="display-5 fw-bold mb-3">Soluciones Completas de Impresi贸n</h2>
                <p class="lead text-muted">Desde alquiler hasta soporte t茅cnico, cubrimos todas tus necesidades</p>
              </div>

              <div class="row g-4">
                <!-- Alquiler -->
                <div class="col-lg-6">
                  <div class="card h-100 border-0 shadow-lg service-card-hover position-relative"
                       data-bs-toggle="modal" data-bs-target="#serviceModal" data-service="alquiler" style="cursor:pointer;">
                    <span class="position-absolute top-0 end-0 m-3 badge bg-primary fs-6">M谩s Popular</span>
                    <div class="position-relative">
                      <img src="/static/img/services/rental-office.jpg" alt="Alquiler de fotocopiadoras" class="card-img-top" style="height:200px;object-fit:cover;"/>
                      <div class="position-absolute bottom-0 start-0 m-3"><span class="badge bg-dark bg-opacity-75 text-white"><i class="bi bi-handshake me-1"></i>Alquiler</span></div>
                    </div>
                    <div class="card-body p-4">
                      <div class="d-flex align-items-start">
                        <div class="service-icon rounded-circle d-flex align-items-center justify-content-center me-3 flex-shrink-0">
                          <i class="bi bi-handshake text-white fs-3"></i>
                        </div>
                        <div class="flex-grow-1">
                          <h3 class="h4 fw-bold mb-3 text-primary">Alquiler de Fotocopiadoras</h3>
                          <p class="text-muted mb-4"><strong>隆Sin inversi贸n inicial!</strong> Equipos de 煤ltima generaci贸n de Konica Minolta, Canon y Ricoh. Mantenimiento, t贸ner y soporte incluido.</p>
                          <div class="row g-2 mb-4">
                            <div class="col-6 d-flex align-items-center"><i class="bi bi-check-circle-fill text-success me-2"></i><small>Sin inversi贸n</small></div>
                            <div class="col-6 d-flex align-items-center"><i class="bi bi-check-circle-fill text-success me-2"></i><small>Mantenimiento incluido</small></div>
                            <div class="col-6 d-flex align-items-center"><i class="bi bi-check-circle-fill text-success me-2"></i><small>Soporte 24/7</small></div>
                            <div class="col-6 d-flex align-items-center"><i class="bi bi-check-circle-fill text-success me-2"></i><small>Instalaci贸n gratis</small></div>
                          </div>
                          <div class="d-flex align-items-center justify-content-between">
                            <span class="pricing-badge badge fs-6 px-3 py-2 rounded-pill">Desde $149/mes</span>
                            <a href="/cotizacion/form" class="btn btn-primary"><i class="bi bi-calculator me-1"></i>Cotizar</a>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Venta -->
                <div class="col-lg-6">
                  <div class="card h-100 border-0 shadow-lg service-card-hover"
                       data-bs-toggle="modal" data-bs-target="#serviceModal" data-service="venta" style="cursor:pointer;">
                    <div class="position-relative">
                      <img src="/static/img/services/equipment-showroom.jpg" alt="Venta de equipos de impresi贸n" class="card-img-top" style="height:200px;object-fit:cover;"/>
                      <div class="position-absolute bottom-0 start-0 m-3"><span class="badge bg-success"><i class="bi bi-cart3 me-1"></i>Venta</span></div>
                    </div>
                    <div class="card-body p-4">
                      <div class="d-flex align-items-start">
                        <div class="bg-success bg-gradient rounded-circle d-flex align-items-center justify-content-center me-3 flex-shrink-0" style="width:60px;height:60px;"><i class="bi bi-cart3 text-white fs-3"></i></div>
                        <div class="flex-grow-1">
                          <h3 class="h4 fw-bold mb-3 text-success">Venta de Equipos Nuevos</h3>
                          <p class="text-muted mb-4"><strong>Equipos nuevos y seminuevos</strong> de las mejores marcas. Asesor铆a especializada y planes de financiamiento.</p>
                          <div class="row g-2 mb-4">
                            <div class="col-6 d-flex align-items-center"><i class="bi bi-check-circle-fill text-success me-2"></i><small>Equipos nuevos</small></div>
                            <div class="col-6 d-flex align-items-center"><i class="bi bi-check-circle-fill text-success me-2"></i><small>Garant铆a oficial</small></div>
                            <div class="col-6 d-flex align-items-center"><i class="bi bi-check-circle-fill text-success me-2"></i><small>Financiamiento</small></div>
                            <div class="col-6 d-flex align-items-center"><i class="bi bi-check-circle-fill text-success me-2"></i><small>Instalaci贸n incluida</small></div>
                          </div>
                          <div class="d-flex align-items-center justify-content-between">
                            <span class="badge bg-success fs-6 px-3 py-2 rounded-pill">Desde $2,999</span>
                            <a href="/contactus" class="btn btn-success"><i class="bi bi-chat-dots me-1"></i>Consultar</a>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Servicio T茅cnico -->
                <div class="col-lg-4">
                  <div class="card h-100 border-0 shadow-sm service-card-hover text-center"
                       data-bs-toggle="modal" data-bs-target="#serviceModal" data-service="tecnico" style="cursor:pointer;">
                    <div class="card-body p-4">
                      <div class="bg-warning bg-gradient rounded-circle d-inline-flex align-items-center justify-content-center mb-4" style="width:80px;height:80px;"><i class="bi bi-tools text-dark fs-1"></i></div>
                      <h3 class="h5 fw-bold mb-3">Servicio T茅cnico</h3>
                      <p class="text-muted mb-4">Mantenimiento y reparaci贸n especializada con t茅cnicos certificados.</p>
                      <div class="mb-4"><div class="badge bg-warning text-dark mb-2 d-block">Tiempo de respuesta</div><h4 class="text-warning mb-0">4 horas</h4></div>
                      <a href="/contactus" class="btn btn-warning text-dark w-100"><i class="bi bi-telephone me-1"></i>Solicitar Servicio</a>
                    </div>
                  </div>
                </div>

                <!-- Repuestos -->
                <div class="col-lg-4">
                  <div class="card h-100 border-0 shadow-sm service-card-hover text-center"
                       data-bs-toggle="modal" data-bs-target="#serviceModal" data-service="repuestos" style="cursor:pointer;">
                    <div class="card-body p-4">
                      <div class="bg-info bg-gradient rounded-circle d-inline-flex align-items-center justify-content-center mb-4" style="width:80px;height:80px;"><i class="bi bi-droplet-fill text-white fs-1"></i></div>
                      <h3 class="h5 fw-bold mb-3">Repuestos y T贸ner</h3>
                      <p class="text-muted mb-4">Amplio inventario de t贸neres originales y repuestos para todas las marcas.</p>
                      <div class="mb-4"><div class="badge bg-info mb-2 d-block">Stock disponible</div><h4 class="text-info mb-0">1000+ items</h4></div>
                      <a href="/contactus" class="btn btn-info w-100"><i class="bi bi-box-seam me-1"></i>Ver Cat谩logo</a>
                    </div>
                  </div>
                </div>

                <!-- Monitoreo -->
                <div class="col-lg-4">
                  <div class="card h-100 border-0 shadow-sm service-card-hover text-center"
                       data-bs-toggle="modal" data-bs-target="#serviceModal" data-service="monitoreo" style="cursor:pointer;">
                    <div class="card-body p-4">
                      <div class="bg-danger bg-gradient rounded-circle d-inline-flex align-items-center justify-content-center mb-4" style="width:80px;height:80px;"><i class="bi bi-graph-up-arrow text-white fs-1"></i></div>
                      <h3 class="h5 fw-bold mb-3">Monitoreo Flota</h3>
                      <p class="text-muted mb-4">Control remoto total de tu flota de impresoras con reportes en tiempo real.</p>
                      <div class="mb-4"><div class="badge bg-danger mb-2 d-block">Acceso remoto</div><h4 class="text-danger mb-0">24/7</h4></div>
                      <a href="https://app.printtrackerpro.com/auth/login" target="_blank" class="btn btn-danger w-100"><i class="bi bi-box-arrow-up-right me-1"></i>Acceder Sistema</a>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

          <!-- PROCESO, GARANTAS, CTA final: (se mantiene como en tu archivo) -->

          <!-- MODAL GENRICO DE SERVICIOS -->
          <div class="modal fade" id="serviceModal" tabindex="-1" aria-labelledby="serviceModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg modal-dialog-centered">
              <div class="modal-content border-0 shadow">
                <div class="modal-header bg-primary text-white">
                  <h5 class="modal-title fw-bold" id="serviceModalLabel"><i class="bi bi-info-circle me-2"></i>Detalles del Servicio</h5>
                  <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body p-4" id="serviceModalBody">
                  <!-- Contenido din谩mico -->
                </div>
                <div class="modal-footer bg-light">
                  <a href="/cotizacion/form" class="btn btn-primary"><i class="bi bi-calculator me-2"></i>Solicitar Cotizaci贸n</a>
                  <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Cerrar</button>
                </div>
              </div>
            </div>
          </div>

          <!-- BOTONES FLOTANTES (ajustados para no chocar con el chat) -->
          <div class="cc-float-right">
            <a href="https://wa.me/51975399303?text=Hola,%20necesito%20informaci贸n%20sobre%20sus%20servicios" target="_blank"
               class="btn btn-success rounded-pill shadow-lg d-flex align-items-center">
              <i class="bi bi-whatsapp fs-4 me-2"></i><span class="d-none d-md-inline fw-semibold">驴Necesitas ayuda?</span>
            </a>
          </div>
          <div class="cc-float-left">
            <a href="/cotizacion/form" class="btn btn-warning rounded-pill shadow-lg d-flex align-items-center">
              <i class="bi bi-calculator fs-4 me-2"></i><span class="d-none d-md-inline fw-semibold text-dark">Cotizaci贸n R谩pida</span>
            </a>
          </div>

          <!-- Carga del JS espec铆fico para esta p谩gina -->
          <script t-att-src="'/copier_company/static/src/js/copier_services_scripts.js'"></script>
        </div>
      </t>
    </template>

      <!-- ========================================== -->
    <!-- TEMPLATE: FORMULARIO SERVICIO TCNICO -->
    <!-- ========================================== -->
    <template id="portal_service_request" name="Solicitud de Servicio T茅cnico">
        <t t-call="portal.frontend_layout">
            <t t-set="additional_title">Solicitar Servicio T茅cnico</t>
            
            <!-- CSS Custom -->
            <t t-set="head">
                <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
                <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet"/>
                <style>
                    .service-header {
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        color: white;
                        padding: 3rem 0;
                        margin-bottom: 2rem;
                        border-radius: 0 0 30px 30px;
                    }
                    .equipment-info-card {
                        background: #f8f9fa;
                        border-left: 4px solid #667eea;
                        padding: 1.5rem;
                        margin-bottom: 2rem;
                        border-radius: 8px;
                    }
                    .form-label {
                        font-weight: 600;
                        color: #495057;
                        margin-bottom: 0.5rem;
                    }
                    .form-control, .form-select {
                        border-radius: 8px;
                        border: 1px solid #dee2e6;
                        padding: 0.75rem;
                    }
                    .form-control:focus, .form-select:focus {
                        border-color: #667eea;
                        box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.25);
                    }
                    .btn-submit {
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        border: none;
                        padding: 1rem 3rem;
                        font-weight: 600;
                        border-radius: 50px;
                        transition: all 0.3s;
                    }
                    .btn-submit:hover {
                        transform: translateY(-2px);
                        box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
                    }
                    .priority-badge {
                        display: inline-block;
                        padding: 0.5rem 1rem;
                        border-radius: 20px;
                        font-weight: 600;
                        margin: 0.25rem;
                        cursor: pointer;
                        transition: all 0.3s;
                    }
                    .priority-badge:hover {
                        transform: scale(1.05);
                    }
                    .success-card {
                        background: #d4edda;
                        border: 1px solid #c3e6cb;
                        border-radius: 12px;
                        padding: 2rem;
                        margin: 2rem 0;
                    }
                    .error-card {
                        background: #f8d7da;
                        border: 1px solid #f5c6cb;
                        border-radius: 12px;
                        padding: 1.5rem;
                        margin: 2rem 0;
                    }
                    .qr-badge {
                        background: #fff3cd;
                        border: 1px solid #ffc107;
                        padding: 1rem;
                        border-radius: 8px;
                        margin-bottom: 1.5rem;
                    }
                    .photo-preview {
                        max-width: 200px;
                        max-height: 200px;
                        margin-top: 1rem;
                        border-radius: 8px;
                        display: none;
                    }
                </style>
            </t>

            <div class="container-fluid p-0">
                <!-- Header -->
                <div class="service-header">
                    <div class="container">
                        <div class="row align-items-center">
                            <div class="col-md-8">
                                <h1 class="display-5 fw-bold mb-2">
                                    <i class="bi bi-tools me-3"></i>
                                    Solicitar Servicio T茅cnico
                                </h1>
                                <p class="lead mb-0">Complete el formulario y nos pondremos en contacto</p>
                            </div>
                            <div class="col-md-4 text-end">
                                <div class="bg-white bg-opacity-25 rounded p-3">
                                    <i class="bi bi-headset fs-1"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="container mb-5">
                    <!-- Mensaje si viene de QR -->
                    <t t-if="from_qr">
                        <div class="qr-badge">
                            <div class="d-flex align-items-center">
                                <i class="bi bi-qr-code fs-2 me-3 text-warning"></i>
                                <div>
                                    <h5 class="mb-1">Acceso mediante c贸digo QR</h5>
                                    <p class="mb-0 small">Por favor ingrese sus datos de contacto para que podamos atenderle</p>
                                </div>
                            </div>
                        </div>
                    </t>

                    <!-- Mensajes de 茅xito/error -->
                    <t t-if="success_message">
                        <div class="success-card">
                            <div class="d-flex align-items-start">
                                <i class="bi bi-check-circle-fill fs-1 text-success me-3"></i>
                                <div class="flex-grow-1">
                                    <h4 class="text-success mb-3">隆Solicitud Creada Exitosamente!</h4>
                                    <div t-raw="success_message"/>
                                    
                                    <div class="mt-4 p-3 bg-white rounded">
                                        <h6 class="fw-bold mb-3">Detalles de su solicitud:</h6>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <p class="mb-2"><strong>N煤mero:</strong> <span class="text-primary" t-esc="request_data.get('number')"/></p>
                                                <p class="mb-2"><strong>Tipo:</strong> <t t-esc="request_data.get('tipo_problema')"/></p>
                                            </div>
                                            <div class="col-md-6">
                                                <p class="mb-2"><strong>Prioridad:</strong> <t t-esc="request_data.get('prioridad')"/></p>
                                                <p class="mb-2"><strong>Estado:</strong> <span class="badge bg-info" t-esc="request_data.get('estado')"/></p>
                                            </div>
                                        </div>
                                        <div class="mt-3">
                                            <p class="mb-1"><strong>Reportado por:</strong> <t t-esc="request_data.get('reportado_por')"/></p>
                                            <p class="mb-1"><strong>Email:</strong> <t t-esc="request_data.get('email')"/></p>
                                            <p class="mb-0"><strong>Tel茅fono:</strong> <t t-esc="request_data.get('telefono')"/></p>
                                        </div>
                                    </div>

                                    <div class="mt-4">
                                        <a t-attf-href="/public/equipment_menu?copier_company_id=#{equipment.id}" 
                                           class="btn btn-primary">
                                            <i class="bi bi-arrow-left me-2"></i>
                                            Volver al Men煤
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </t>

                    <t t-if="error_message">
                        <div class="error-card">
                            <div class="d-flex align-items-start">
                                <i class="bi bi-exclamation-triangle-fill fs-2 text-danger me-3"></i>
                                <div>
                                    <h5 class="text-danger mb-2">Error al procesar la solicitud</h5>
                                    <p class="mb-0" t-esc="error_message"/>
                                </div>
                            </div>
                        </div>
                    </t>

                    <!-- Formulario (solo mostrar si NO hay 茅xito) -->
                    <t t-if="not success_message">
                        <!-- Informaci贸n del Equipo -->
                        <div class="equipment-info-card">
                            <h5 class="mb-3">
                                <i class="bi bi-printer me-2"></i>
                                Informaci贸n del Equipo
                            </h5>
                            <div class="row">
                                <div class="col-md-6">
                                    <p class="mb-2">
                                        <strong>Equipo:</strong> 
                                        <span t-esc="equipment_data.get('name')"/>
                                    </p>
                                    <p class="mb-2">
                                        <strong>Serie:</strong> 
                                        <span t-esc="equipment_data.get('serie')"/>
                                    </p>
                                    <p class="mb-0">
                                        <strong>Marca:</strong> 
                                        <span t-esc="equipment_data.get('marca')"/>
                                    </p>
                                </div>
                                <div class="col-md-6">
                                    <p class="mb-2">
                                        <strong>Ubicaci贸n:</strong> 
                                        <span t-esc="equipment_data.get('ubicacion')"/>
                                    </p>
                                    <p class="mb-2">
                                        <strong>Tipo:</strong> 
                                        <span t-esc="equipment_data.get('tipo')"/>
                                    </p>
                                    <p class="mb-0">
                                        <strong>Cliente:</strong> 
                                        <span t-esc="equipment_data.get('cliente_name')"/>
                                    </p>
                                </div>
                            </div>
                        </div>

                        <!-- Formulario -->
                        <form method="POST" enctype="multipart/form-data" id="serviceForm">
                            <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>

                            <!-- Secci贸n: Datos de Contacto -->
                            <div class="card shadow-sm mb-4">
                                <div class="card-header bg-primary text-white">
                                    <h5 class="mb-0">
                                        <i class="bi bi-person-fill me-2"></i>
                                        Datos de Contacto
                                        <span class="badge bg-warning text-dark ms-2">OBLIGATORIO</span>
                                    </h5>
                                </div>
                                <div class="card-body">

                                    <!-- Si NO est谩 logueado: mostrar campos normales -->
                                    <t t-if="not is_logged">
                                        <div class="row">
                                            <div class="col-md-4 mb-3">
                                                <label class="form-label" for="contacto">
                                                    Nombre Completo <span class="text-danger">*</span>
                                                </label>
                                                <input type="text"
                                                    class="form-control"
                                                    id="contacto"
                                                    name="contacto"
                                                    t-att-value="contact_data.get('contacto', '')"
                                                    placeholder="Ej: Juan P茅rez L贸pez"
                                                    required="required"/>
                                                <small class="text-muted">Persona que reporta el problema</small>
                                            </div>

                                            <div class="col-md-4 mb-3">
                                                <label class="form-label" for="correo">
                                                    Email <span class="text-danger">*</span>
                                                </label>
                                                <input type="email"
                                                    class="form-control"
                                                    id="correo"
                                                    name="correo"
                                                    t-att-value="contact_data.get('correo', '')"
                                                    placeholder="ejemplo@empresa.com"
                                                    required="required"/>
                                                <small class="text-muted">Para notificaciones y seguimiento</small>
                                            </div>

                                            <div class="col-md-4 mb-3">
                                                <label class="form-label" for="telefono_contacto">
                                                    Tel茅fono/Celular <span class="text-danger">*</span>
                                                </label>
                                                <input type="tel"
                                                    class="form-control"
                                                    id="telefono_contacto"
                                                    name="telefono_contacto"
                                                    t-att-value="contact_data.get('telefono_contacto', '')"
                                                    placeholder="987654321"
                                                    pattern="[0-9]{9,15}"
                                                    required="required"/>
                                                <small class="text-muted">M铆nimo 9 d铆gitos</small>
                                            </div>
                                        </div>
                                    </t>

                                    <!-- Si S est谩 logueado: no pedir datos, enviarlos ocultos -->
                                    <t t-else="">
                                        <!-- Inputs ocultos para que el POST tenga datos -->
                                        <input type="hidden" name="contacto"
                                            t-att-value="contact_data.get('contacto', '')"/>
                                        <input type="hidden" name="correo"
                                            t-att-value="contact_data.get('correo', '')"/>
                                        <input type="hidden" name="telefono_contacto"
                                            t-att-value="contact_data.get('telefono_contacto', '')"/>

                                        <!-- Mostrar datos solo informativos -->
                                        <div class="alert alert-info mb-0">
                                            <h6 class="fw-bold mb-2">
                                                <i class="bi bi-person-check me-2"></i>
                                                Datos del usuario logueado
                                            </h6>
                                            <p class="mb-1">
                                                <strong>Nombre:</strong>
                                                <t t-esc="contact_data.get('contacto')"/>
                                            </p>
                                            <p class="mb-1">
                                                <strong>Email:</strong>
                                                <t t-esc="contact_data.get('correo')"/>
                                            </p>
                                            <p class="mb-0">
                                                <strong>Tel茅fono:</strong>
                                                <t t-esc="contact_data.get('telefono_contacto')"/>
                                            </p>
                                            <small class="text-muted">
                                                Estos datos se enviar谩n autom谩ticamente con la solicitud.
                                            </small>
                                        </div>
                                    </t>

                                </div>
                                
                            </div>

                            <!-- Secci贸n: Descripci贸n del Problema -->
                            <div class="card shadow-sm mb-4">
                                <div class="card-header bg-danger text-white">
                                    <h5 class="mb-0">
                                        <i class="bi bi-exclamation-circle-fill me-2"></i>
                                        Descripci贸n del Problema
                                    </h5>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label class="form-label" for="tipo_problema_id">
                                                Tipo de Problema <span class="text-danger">*</span>
                                            </label>
                                            <select class="form-select" 
                                                    id="tipo_problema_id" 
                                                    name="tipo_problema_id" 
                                                    required="required">
                                                <option value="">-- Seleccione un tipo --</option>
                                                <t t-foreach="problem_types" t-as="ptype">
                                                    <option t-att-value="ptype.id">
                                                        <t t-esc="ptype.icono"/> <t t-esc="ptype.name"/>
                                                    </option>
                                                </t>
                                            </select>
                                        </div>

                                        <div class="col-md-6 mb-3">
                                            <label class="form-label">
                                                Prioridad <span class="text-danger">*</span>
                                            </label>
                                            <div class="d-flex flex-wrap gap-2">
                                                <input type="radio" class="btn-check" name="prioridad" id="prioridad_baja" value="0"/>
                                                <label class="priority-badge bg-success text-white" for="prioridad_baja">
                                                     Baja
                                                </label>

                                                <input type="radio" class="btn-check" name="prioridad" id="prioridad_normal" value="1" checked="checked"/>
                                                <label class="priority-badge bg-info text-white" for="prioridad_normal">
                                                     Normal
                                                </label>

                                                <input type="radio" class="btn-check" name="prioridad" id="prioridad_alta" value="2"/>
                                                <label class="priority-badge bg-warning text-dark" for="prioridad_alta">
                                                     Alta
                                                </label>

                                                <input type="radio" class="btn-check" name="prioridad" id="prioridad_critica" value="3"/>
                                                <label class="priority-badge bg-danger text-white" for="prioridad_critica">
                                                     Cr铆tica
                                                </label>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="mb-3">
                                        <label class="form-label" for="problema_reportado">
                                            Descripci贸n Detallada <span class="text-danger">*</span>
                                        </label>
                                        <textarea class="form-control" 
                                                  id="problema_reportado" 
                                                  name="problema_reportado" 
                                                  rows="5" 
                                                  placeholder="Describa el problema con el mayor detalle posible. Ej: La impresora no imprime desde hace 2 d铆as, muestra mensaje de error 'E000020-0001'..."
                                                  required="required"></textarea>
                                        <small class="text-muted">
                                            Sea lo m谩s espec铆fico posible. Incluya mensajes de error si los hay.
                                        </small>
                                    </div>

                                    <div class="mb-3">
                                        <label class="form-label" for="foto_antes">
                                            Foto del Problema (Opcional)
                                        </label>
                                        <input type="file" 
                                               class="form-control" 
                                               id="foto_antes" 
                                               name="foto_antes" 
                                               accept="image/*"
                                               onchange="previewImage(this)"/>
                                        <small class="text-muted">
                                            Si es posible, adjunte una foto del error o problema
                                        </small>
                                        <img id="imagePreview" class="photo-preview img-thumbnail" alt="Vista previa"/>
                                    </div>
                                </div>
                            </div>

                            <!-- Botones -->
                            <div class="text-center my-5">
                                <button type="submit" class="btn btn-primary btn-submit btn-lg">
                                    <i class="bi bi-send-fill me-2"></i>
                                    Enviar Solicitud de Servicio
                                </button>
                                <br/>
                                <a t-attf-href="/public/equipment_menu?copier_company_id=#{equipment.id}" 
                                   class="btn btn-link mt-3">
                                    <i class="bi bi-arrow-left me-2"></i>
                                    Volver al Men煤
                                </a>
                            </div>
                        </form>
                    </t>
                </div>
            </div>

            <!-- JavaScript -->
            <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
            <script>
                // Preview de imagen
                function previewImage(input) {
                    const preview = document.getElementById('imagePreview');
                    if (input.files &amp;&amp; input.files[0]) {
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            preview.src = e.target.result;
                            preview.style.display = 'block';
                        }
                        reader.readAsDataURL(input.files[0]);
                    } else {
                        preview.style.display = 'none';
                    }
                }

                // Validaci贸n del formulario
                (function() {
                    'use strict';
                    const form = document.getElementById('serviceForm');
                    if (form) {
                        form.addEventListener('submit', function(event) {
                            if (!form.checkValidity()) {
                                event.preventDefault();
                                event.stopPropagation();
                            }
                            form.classList.add('was-validated');
                        }, false);
                    }
                })();
            </script>
        </t>
    </template>
  </data>
</odoo>
