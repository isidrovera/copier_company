<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- ========================================= -->
    <!-- VISTA FORMULARIO -->
    <!-- ========================================= -->
    <record id="view_whatsapp_config_form" model="ir.ui.view">
        <field name="name">whatsapp.config.form</field>
        <field name="model">whatsapp.config</field>
        <field name="arch" type="xml">
            <form string="Configuraci√≥n WhatsApp">
                <header>
                    <button name="check_connection" 
                            string="üîå Verificar Conexi√≥n" 
                            type="object" 
                            class="oe_highlight"/>
                    <button name="action_open_qr_page" 
                            string="üì± Ver C√≥digo QR" 
                            type="object" 
                            class="oe_highlight"/>
                    <button name="action_test_notification" 
                            string="üß™ Enviar Prueba" 
                            type="object"/>
                </header>
                <sheet>
                    <widget name="web_ribbon" title="Activo" bg_color="text-bg-success" invisible="not active"/>
                    <widget name="web_ribbon" title="Inactivo" bg_color="text-bg-danger" invisible="active"/>
                    
                    <div class="oe_button_box" name="button_box">
                        <button name="toggle_active" 
                                type="object" 
                                class="oe_stat_button" 
                                icon="fa-archive">
                            <field name="active" widget="boolean_button" options="{'terminology': 'archive'}"/>
                        </button>
                        <button type="object" 
                                name="check_connection" 
                                class="oe_stat_button" 
                                icon="fa-plug">
                            <field name="is_connected" 
                                   widget="boolean" 
                                   options="{'terminology': {'string_true': 'Conectado', 'string_false': 'Desconectado', 'hover_true': '‚úÖ WhatsApp Conectado', 'hover_false': '‚ùå WhatsApp Desconectado'}}"/>
                        </button>
                    </div>
                    
                    <div class="oe_title">
                        <label for="name" string="Configuraci√≥n"/>
                        <h1>
                            <field name="name" placeholder="Nombre de configuraci√≥n..."/>
                        </h1>
                    </div>
                    
                    <group>
                        <group name="connection" string="üîó Configuraci√≥n de Conexi√≥n">
                            <field name="api_url" placeholder="http://localhost:3000"/>
                            <field name="api_key" password="True"/>
                            <field name="session_name"/>
                            <field name="sequence"/>
                        </group>
                        
                        <group name="status" string="üìä Estado">
                            <field name="last_check" readonly="1"/>
                            <field name="connection_status" widget="text" readonly="1"/>
                        </group>
                    </group>
                    
                    <notebook>
                        <page string="üìû Contactos T√©cnicos" name="contacts">
                            <group>
                                <group>
                                    <label for="technical_phones" string="Tel√©fonos T√©cnicos"/>
                                    <div>
                                        <field name="technical_phones" 
                                               widget="text" 
                                               placeholder="51987654321&#10;51999888777&#10;51988776655"
                                               nolabel="1"/>
                                        <div class="text-muted">
                                            <small>Un n√∫mero por l√≠nea o separados por coma. Formato: 51987654321</small>
                                        </div>
                                    </div>
                                    
                                    <field name="supervisor_phone" placeholder="51924894829"/>
                                </group>
                                <group>
                                    <field name="backup_phone" placeholder="51924894829"/>
                                </group>
                            </group>
                        </page>
                        
                        <page string="‚öôÔ∏è Configuraci√≥n de Notificaciones" name="notifications">
                            <group>
                                <group string="Opciones de Env√≠o">
                                    <field name="notify_client"/>
                                    <field name="notify_technical"/>
                                    <field name="notify_high_priority"/>
                                    <field name="send_photos"/>
                                </group>
                                <group string="Opciones de Sistema">
                                    <field name="log_messages"/>
                                </group>
                            </group>
                        </page>
                        
                        <page string="üìù Plantillas de Mensajes" name="templates">
                            <group>
                                <separator string="Plantilla para Cliente"/>
                                <field name="client_message_template" 
                                       widget="text" 
                                       nolabel="1"
                                       placeholder="Variables: {contacto}, {numero_ticket}, {equipo}, {ubicacion}, {sede}, {tipo_problema}, {prioridad}, {descripcion}"/>
                            </group>
                            <group>
                                <separator string="Plantilla para T√©cnicos"/>
                                <field name="technical_message_template" 
                                       widget="text" 
                                       nolabel="1"
                                       placeholder="Variables: {numero_ticket}, {prioridad}, {fecha_creacion}, {cliente}, {contacto}, {telefono}, {email}, {modelo}, {serie}, {marca}, {ubicacion}, {sede}, {tipo_problema}, {descripcion}, {origen}"/>
                            </group>
                        </page>
                        
                        <page string="üìà Estad√≠sticas" name="stats">
                            <group>
                                <group string="Mensajes Enviados">
                                    <field name="total_messages_sent" readonly="1"/>
                                    <field name="total_messages_failed" readonly="1"/>
                                </group>
                                <group string="√öltima Actividad">
                                    <field name="last_message_date" readonly="1"/>
                                </group>
                            </group>
                        </page>
                    </notebook>
                </sheet>
                <chatter/>
            </form>
        </field>
    </record>

    <!-- ========================================= -->
    <!-- VISTA LISTA -->
    <!-- ========================================= -->
    <record id="view_whatsapp_config_list" model="ir.ui.view">
        <field name="name">whatsapp.config.list</field>
        <field name="model">whatsapp.config</field>
        <field name="arch" type="xml">
            <list string="Configuraciones WhatsApp" default_order="sequence, id">
                <field name="sequence" widget="handle"/>
                <field name="name"/>
                <field name="api_url"/>
                <field name="is_connected" widget="boolean_toggle" readonly="1"/>
                <field name="last_check" optional="show"/>
                <field name="total_messages_sent" optional="show" sum="Total"/>
                <field name="total_messages_failed" optional="hide"/>
                <field name="active" widget="boolean_toggle"/>
            </list>
        </field>
    </record>

    <!-- ========================================= -->
    <!-- VISTA B√öSQUEDA -->
    <!-- ========================================= -->
    

    <!-- ========================================= -->
    <!-- WIZARD: MENSAJE DE PRUEBA -->
    <!-- ========================================= -->
    <record id="view_whatsapp_test_message_wizard_form" model="ir.ui.view">
        <field name="name">whatsapp.test.message.wizard.form</field>
        <field name="model">whatsapp.test.message.wizard</field>
        <field name="arch" type="xml">
            <form string="Enviar Mensaje de Prueba">
                <group>
                    <field name="config_id" invisible="1"/>
                    <field name="phone" placeholder="51987654321"/>
                    <field name="message" widget="text"/>
                </group>
                <footer>
                    <button string="üì§ Enviar" 
                            name="action_send_test" 
                            type="object" 
                            class="oe_highlight"/>
                    <button string="Cancelar" 
                            class="btn-secondary" 
                            special="cancel"/>
                </footer>
            </form>
        </field>
    </record>

    

</odoo>