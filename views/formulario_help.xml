<odoo>
    <template id="ticket_form_inherit" inherit_id="website_helpdesk.team_form_1" name="Helpdesk Ticket Form Inherit">
        <xpath expr="//input[@id='helpdesk3']/parent::div" position="after">
            <!-- Agregar campos 'Serie' y 'Modelo' después del campo 'Asunto' -->
            <div class="mb-0 py-2 s_website_form_field col-12" data-type="many2one" data-name="Field">
                <div class="row s_col_no_resize s_col_no_bgcolor">
                    <label class="col-form-label col-sm-auto s_website_form_label" style="width: 200px" for="select_serie">
                        <span class="s_website_form_label_content">Serie</span>
                    </label>
                    <div class="col-sm">
                        <select class="form-control s_website_form_input" name="producto_id" id="select_serie">
                            <!-- Las opciones serán llenadas dinámicamente por JavaScript -->
                        </select>
                    </div>
                </div>
            </div>
            <div class="mb-0 py-2 s_website_form_field col-12" data-type="char" data-name="Field">
                <div class="row s_col_no_resize s_col_no_bgcolor">
                    <label class="col-form-label col-sm-auto s_website_form_label" style="width: 200px" for="input_modelo">
                        <span class="s_website_form_label_content">Modelo</span>
                    </label>
                    <div class="col-sm">
                        <input type="text" class="form-control s_website_form_input" name="serie_id" id="input_modelo" readonly="1"/>
                    </div>
                </div>
            </div>
        </xpath>
        <!-- Inyectar JavaScript para poblar el campo Many2one -->
        <xpath expr="//form" position="after">
            <script type="text/javascript">
                $(document).ready(function(){
                    $.ajax({
                        url: '/helpdesk/get_series',
                        method: 'GET', // Cambio a 'GET' aquí
                        dataType: 'json',
                        success: function(data) {
                            var select = $('#select_serie'); // Asegúrate de que este ID coincida con el ID del campo select en el HTML
                            select.empty(); // Limpia las opciones existentes
                            // Añadir un valor predeterminado en la parte superior
                            select.append($('<option/>', {
                                value: '',
                                text: 'Seleccione una serie...'
                            }));
                            // Añadir las opciones obtenidas del controlador
                            $.each(data, function(index, item) {
                                select.append($('<option/>', {
                                    value: item.id,
                                    text: item.name
                                }));
                            });
                        },
                        error: function() {
                            alert("Error al cargar las series");
                        }
                    });
                });
            </script>
        </xpath>
    </template>
</odoo>
