<odoo>
    <!-- MEN√ö PRINCIPAL DEL EQUIPO -->
<template id="portal_equipment_menu" name="Equipment Services Menu">
    <t t-call="website.layout">
        <div id="wrap">
            
            <!-- CDN Libraries -->
            <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.10.5/font/bootstrap-icons.min.css" rel="stylesheet"/>
            <link href="https://cdnjs.cloudflare.com/ajax/libs/feather-icons/4.29.0/feather.min.css" rel="stylesheet"/>
            <link href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css" rel="stylesheet"/>
            <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&amp;display=swap" rel="stylesheet"/>
            
            <!-- CSS personalizado -->
            <style>
                :root {
                    --primary: #667eea;
                    --primary-dark: #764ba2;
                    --secondary: #f093fb;
                    --secondary-dark: #f5576c;
                    --accent: #4facfe;
                    --accent-dark: #00f2fe;
                    --success: #11998e;
                    --success-dark: #38ef7d;
                    --warning: #ffeaa7;
                    --warning-dark: #fab1a0;
                    --danger: #ff6b6b;
                    --danger-dark: #ffa726;
                    --glass-bg: rgba(255, 255, 255, 0.25);
                    --glass-border: rgba(255, 255, 255, 0.18);
                    --shadow-soft: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
                    --shadow-hover: 0 15px 35px rgba(0, 0, 0, 0.1), 0 3px 10px rgba(0, 0, 0, 0.07);
                    --border-radius: 20px;
                    --transition: all 0.4s cubic-bezier(0.165, 0.84, 0.44, 1);
                }
                
                * {
                    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
                }
                
                body {
                    background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
                    min-height: 100vh;
                }
                
                /* Hero Section */
                .hero-section {
                    background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
                    color: white;
                    position: relative;
                    overflow: hidden;
                    min-height: 400px;
                    display: flex;
                    align-items: center;
                }
                
                .hero-section::before {
                    content: '';
                    position: absolute;
                    top: 0;
                    left: 0;
                    right: 0;
                    bottom: 0;
                    background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.1'%3E%3Ccircle cx='30' cy='30' r='2'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
                }
                
                .hero-content {
                    position: relative;
                    z-index: 2;
                }
                
                .hero-icon {
                    width: 120px;
                    height: 120px;
                    background: var(--glass-bg);
                    border: 1px solid var(--glass-border);
                    backdrop-filter: blur(10px);
                    border-radius: 30px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    margin: 0 auto 2rem;
                    animation: float 3s ease-in-out infinite;
                    font-size: 3rem;
                }
                
                @keyframes float {
                    0%, 100% { transform: translateY(0px); }
                    50% { transform: translateY(-10px); }
                }
                
                .hero-title {
                    font-size: 3.5rem;
                    font-weight: 800;
                    margin-bottom: 1rem;
                    background: linear-gradient(45deg, #fff, #f8f9fa);
                    background-clip: text;
                    -webkit-background-clip: text;
                    -webkit-text-fill-color: transparent;
                }
                
                .hero-subtitle {
                    font-size: 1.25rem;
                    opacity: 0.9;
                    font-weight: 400;
                }
                
                /* Glass Card */
                .glass-card {
                    background: var(--glass-bg);
                    border: 1px solid var(--glass-border);
                    backdrop-filter: blur(20px);
                    border-radius: var(--border-radius);
                    box-shadow: var(--shadow-soft);
                    padding: 2.5rem;
                    margin: -100px auto 3rem;
                    position: relative;
                    z-index: 10;
                    max-width: 900px;
                }
                
                /* Equipment Info Grid */
                .equipment-grid {
                    display: grid;
                    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
                    gap: 1.5rem;
                    margin-bottom: 2rem;
                }
                
                .info-card {
                    background: rgba(255, 255, 255, 0.9);
                    border-radius: 16px;
                    padding: 1.5rem;
                    border: 1px solid rgba(255, 255, 255, 0.3);
                    transition: var(--transition);
                    position: relative;
                    overflow: hidden;
                }
                
                .info-card::before {
                    content: '';
                    position: absolute;
                    top: 0;
                    left: 0;
                    width: 4px;
                    height: 100%;
                    background: linear-gradient(135deg, var(--primary), var(--primary-dark));
                    border-radius: 2px;
                }
                
                .info-card:hover {
                    transform: translateY(-2px);
                    box-shadow: var(--shadow-hover);
                }
                
                .info-header {
                    display: flex;
                    align-items: center;
                    margin-bottom: 0.75rem;
                }
                
                .info-icon {
                    width: 40px;
                    height: 40px;
                    border-radius: 10px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    margin-right: 1rem;
                    color: white;
                    font-size: 1.1rem;
                }
                
                .info-label {
                    font-weight: 600;
                    color: #1e293b;
                    font-size: 0.9rem;
                    text-transform: uppercase;
                    letter-spacing: 0.05em;
                }
                
                .info-value {
                    color: #64748b;
                    font-size: 1rem;
                    font-weight: 500;
                }
                
                /* Service Cards */
                .services-grid {
                    display: grid;
                    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
                    gap: 2rem;
                    margin-bottom: 3rem;
                }
                
                .service-card {
                    background: white;
                    border-radius: var(--border-radius);
                    padding: 2rem;
                    text-align: center;
                    transition: var(--transition);
                    border: 1px solid #e2e8f0;
                    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
                    position: relative;
                    overflow: hidden;
                    cursor: pointer;
                    text-decoration: none;
                    color: inherit;
                    display: block;
                }
                
                .service-card::before {
                    content: '';
                    position: absolute;
                    top: 0;
                    left: -100%;
                    width: 100%;
                    height: 100%;
                    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.6), transparent);
                    transition: left 0.6s;
                }
                
                .service-card:hover::before {
                    left: 100%;
                }
                
                .service-card:hover {
                    transform: translateY(-8px) scale(1.02);
                    box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.15);
                    border-color: transparent;
                    text-decoration: none;
                    color: inherit;
                }
                
                .service-icon {
                    width: 80px;
                    height: 80px;
                    border-radius: 20px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    margin: 0 auto 1.5rem;
                    font-size: 2rem;
                    transition: var(--transition);
                    color: white;
                    position: relative;
                }
                
                .service-card:hover .service-icon {
                    transform: scale(1.1) rotate(5deg);
                }
                
                .service-title {
                    font-size: 1.25rem;
                    font-weight: 700;
                    margin-bottom: 0.75rem;
                    color: #1e293b;
                }
                
                .service-description {
                    color: #64748b;
                    font-size: 0.95rem;
                    line-height: 1.6;
                    margin: 0;
                }
                
                /* Status Badge */
                .status-badge {
                    background: linear-gradient(135deg, var(--success), var(--success-dark));
                    color: white;
                    padding: 0.5rem 1.25rem;
                    border-radius: 50px;
                    font-weight: 600;
                    font-size: 0.9rem;
                    border: none;
                    box-shadow: 0 4px 15px rgba(17, 153, 142, 0.4);
                    animation: pulse 2s infinite;
                }
                
                @keyframes pulse {
                    0%, 100% { box-shadow: 0 4px 15px rgba(17, 153, 142, 0.4); }
                    50% { box-shadow: 0 4px 25px rgba(17, 153, 142, 0.6); }
                }
                
                /* Contact Card */
                .contact-card {
                    background: white;
                    border-radius: var(--border-radius);
                    padding: 2.5rem;
                    box-shadow: var(--shadow-soft);
                    border: 1px solid rgba(255, 255, 255, 0.3);
                    position: relative;
                    overflow: hidden;
                }
                
                .contact-card::before {
                    content: '';
                    position: absolute;
                    top: 0;
                    left: 0;
                    right: 0;
                    height: 4px;
                    background: linear-gradient(135deg, var(--primary), var(--primary-dark));
                }
                
                .contact-grid {
                    display: grid;
                    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                    gap: 2rem;
                    margin-top: 2rem;
                }
                
                .contact-item {
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    padding: 1rem;
                    background: #f8fafc;
                    border-radius: 12px;
                    transition: var(--transition);
                }
                
                .contact-item:hover {
                    background: #e2e8f0;
                    transform: translateY(-2px);
                }
                
                .contact-icon {
                    margin-right: 0.75rem;
                    color: var(--primary);
                    font-size: 1.25rem;
                }
                
                /* Service Colors */
                .service-support { background: linear-gradient(135deg, var(--danger), var(--danger-dark)); }
                .service-remote { background: linear-gradient(135deg, var(--accent), var(--accent-dark)); }
                .service-toner { background: linear-gradient(135deg, var(--success), var(--success-dark)); }
                .service-whatsapp { background: linear-gradient(135deg, #25d366, #128c7e); }
                .service-email { background: linear-gradient(135deg, var(--primary), var(--primary-dark)); }
                .service-counters { background: linear-gradient(135deg, var(--secondary), var(--secondary-dark)); }
                .service-quote { background: linear-gradient(135deg, var(--warning), var(--warning-dark)); }
                .service-website { background: linear-gradient(135deg, #a8edea, #fed6e3); }
                
                /* Responsive */
                @media (max-width: 768px) {
                    .hero-title {
                        font-size: 2.5rem;
                    }
                    
                    .glass-card {
                        margin: -60px 1rem 2rem;
                        padding: 2rem 1.5rem;
                    }
                    
                    .services-grid {
                        grid-template-columns: 1fr;
                        gap: 1.5rem;
                    }
                    
                    .service-card {
                        padding: 1.5rem;
                    }
                    
                    .service-icon {
                        width: 70px;
                        height: 70px;
                        font-size: 1.75rem;
                    }
                    
                    .equipment-grid {
                        grid-template-columns: 1fr;
                        gap: 1rem;
                    }
                }
                
                /* Loading animation */
                .loading {
                    opacity: 0;
                    transform: translateY(30px);
                    transition: all 0.6s ease-out;
                }
                
                .loading.loaded {
                    opacity: 1;
                    transform: translateY(0);
                }
                
                /* Custom animations */
                .animate-fadeInUp {
                    animation: fadeInUp 0.8s ease-out;
                }
                
                @keyframes fadeInUp {
                    from {
                        opacity: 0;
                        transform: translateY(30px);
                    }
                    to {
                        opacity: 1;
                        transform: translateY(0);
                    }
                }
                
                .animate-fadeInDown {
                    animation: fadeInDown 0.8s ease-out;
                }
                
                @keyframes fadeInDown {
                    from {
                        opacity: 0;
                        transform: translateY(-30px);
                    }
                    to {
                        opacity: 1;
                        transform: translateY(0);
                    }
                }
                
                .animate-delay-1s {
                    animation-delay: 1s;
                }
                
                .animate-delay-2s {
                    animation-delay: 2s;
                }
            </style>
            
            <!-- Hero Section -->
            <div class="hero-section">
                <div class="container">
                    <div class="hero-content text-center animate-fadeInUp">
                        <div class="hero-icon">
                            <i class="bi bi-gear-fill"></i>
                        </div>
                        <h1 class="hero-title animate-fadeInDown">Centro de Servicios</h1>
                        <p class="hero-subtitle animate-fadeInUp animate-delay-1s">
                            Gestiona tu equipo de forma r√°pida y sencilla
                        </p>
                    </div>
                </div>
            </div>
            
            <div class="container">
                <!-- Informaci√≥n del Equipo -->
                <div class="glass-card animate-fadeInUp">
                    <div class="d-flex justify-content-between align-items-center mb-4 flex-wrap">
                        <div>
                            <h2 class="h3 fw-bold text-dark mb-2">
                                <i class="bi bi-server me-2"></i>
                                Informaci√≥n del Equipo
                            </h2>
                            <p class="text-muted mb-0">Detalles de tu equipo registrado</p>
                        </div>
                        <div class="status-badge">
                            <i class="bi bi-wifi me-2"></i>
                            Activo
                        </div>
                    </div>
                    
                    <div class="equipment-grid">
                        <div class="info-card loading">
                            <div class="info-header">
                                <div class="info-icon service-support">
                                    <i class="bi bi-printer"></i>
                                </div>
                                <div class="info-label">Equipo</div>
                            </div>
                            <div class="info-value">
                                <t t-if="equipment.name">
                                    <span t-esc="equipment.name.name"/>
                                </t>
                                <t t-else="">
                                    Sin nombre
                                </t>
                            </div>
                        </div>
                        
                        <div class="info-card loading">
                            <div class="info-header">
                                <div class="info-icon service-remote">
                                    <i class="bi bi-hash"></i>
                                </div>
                                <div class="info-label">Serie</div>
                            </div>
                            <div class="info-value">
                                <t t-if="equipment.serie_id">
                                    <span t-esc="equipment.serie_id"/>
                                </t>
                                <t t-else="">
                                    Sin serie
                                </t>
                            </div>
                        </div>
                        
                        <div class="info-card loading">
                            <div class="info-header">
                                <div class="info-icon service-toner">
                                    <i class="bi bi-building"></i>
                                </div>
                                <div class="info-label">Cliente</div>
                            </div>
                            <div class="info-value">
                                <t t-if="equipment.cliente_id">
                                    <span t-esc="equipment.cliente_id.name"/>
                                </t>
                                <t t-else="">
                                    Sin cliente
                                </t>
                            </div>
                        </div>
                        
                        <div class="info-card loading">
                            <div class="info-header">
                                <div class="info-icon service-whatsapp">
                                    <i class="bi bi-geo-alt"></i>
                                </div>
                                <div class="info-label">Ubicaci√≥n</div>
                            </div>
                            <div class="info-value">
                                <t t-if="equipment.ubicacion">
                                    <span t-esc="equipment.ubicacion"/>
                                </t>
                                <t t-else="">
                                    Sin ubicaci√≥n
                                </t>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Servicios Disponibles -->
                <div class="text-center mb-5 animate-fadeInUp">
                    <h2 class="h2 fw-bold mb-3">¬øQu√© necesitas hacer hoy?</h2>
                    <p class="text-muted fs-5">Selecciona el servicio que necesitas</p>
                </div>
                
                <div class="services-grid mb-5">
                    <!-- Reportar Problema -->
                    <a t-attf-href="/public/helpdesk_ticket?copier_company_id=#{equipment.id}" 
                       class="service-card loading">
                        <div class="service-icon service-support">
                            <i class="bi bi-exclamation-triangle-fill"></i>
                        </div>
                        <h3 class="service-title">Reportar Problema</h3>
                        <p class="service-description">
                            Reporta fallas t√©cnicas o problemas con tu equipo
                        </p>
                    </a>
                    
                    <!-- Asistencia Remota -->
                    <a t-attf-href="/public/remote_assistance?copier_company_id=#{equipment.id}" 
                       class="service-card loading">
                        <div class="service-icon service-remote">
                            <i class="bi bi-display"></i>
                        </div>
                        <h3 class="service-title">Asistencia Remota</h3>
                        <p class="service-description">
                            Solicita ayuda t√©cnica remota para tu equipo
                        </p>
                    </a>
                    
                    <!-- Solicitar Toner -->
                    <a t-attf-href="/public/request_toner?copier_company_id=#{equipment.id}" 
                       class="service-card loading">
                        <div class="service-icon service-toner">
                            <i class="bi bi-droplet-fill"></i>
                        </div>
                        <h3 class="service-title">Solicitar Toner</h3>
                        <p class="service-description">
                            Pide reposici√≥n de toner y consumibles
                        </p>
                    </a>
                    
                    <!-- Subir Contadores -->
                    <a t-attf-href="/public/upload_counters?copier_company_id=#{equipment.id}" 
                       class="service-card loading">
                        <div class="service-icon service-counters">
                            <i class="bi bi-bar-chart-fill"></i>
                        </div>
                        <h3 class="service-title">Reportar Contadores</h3>
                        <p class="service-description">
                            Env√≠a las lecturas mensuales de tu equipo
                        </p>
                    </a>
                    
                    <!-- WhatsApp -->
                    <a href="https://wa.me/message/XNGGOGE4PPOGO1" target="_blank" 
                       class="service-card loading">
                        <div class="service-icon service-whatsapp">
                            <i class="bi bi-whatsapp"></i>
                        </div>
                        <h3 class="service-title">Chat WhatsApp</h3>
                        <p class="service-description">
                            Contacta directamente por WhatsApp
                        </p>
                    </a>
                    
                    <!-- Enviar Email -->
                    <a href="mailto:info@copiercompanysac.com?subject=Consulta%20sobre%20equipo&amp;body=Hola,%20tengo%20una%20consulta%20sobre%20mi%20equipo." 
                       class="service-card loading">
                        <div class="service-icon service-email">
                            <i class="bi bi-envelope-fill"></i>
                        </div>
                        <h3 class="service-title">Enviar Email</h3>
                        <p class="service-description">
                            Contacta por correo electr√≥nico
                        </p>
                    </a>
                    
                    <!-- Solicitar Cotizaci√≥n -->
                    <a href="https://copiercompanysac.com/cotizacion/form" target="_blank" 
                       class="service-card loading">
                        <div class="service-icon service-quote">
                            <i class="bi bi-file-earmark-text-fill"></i>
                        </div>
                        <h3 class="service-title">Solicitar Cotizaci√≥n</h3>
                        <p class="service-description">
                            Cotiza nuevos equipos o servicios
                        </p>
                    </a>
                    
                    <!-- Visitar Sitio Web -->
                    <a href="https://copiercompanysac.com" target="_blank" 
                       class="service-card loading">
                        <div class="service-icon service-website">
                            <i class="bi bi-globe"></i>
                        </div>
                        <h3 class="service-title">Nuestro Sitio Web</h3>
                        <p class="service-description">
                            Conoce m√°s sobre nuestros servicios
                        </p>
                    </a>
                </div>
                
                <!-- Informaci√≥n de Contacto -->
                <div class="contact-card animate-fadeInUp">
                    <div class="text-center">
                        <div class="hero-icon mx-auto mb-3" style="width: 80px; height: 80px; font-size: 2rem;">
                            <i class="bi bi-headset"></i>
                        </div>
                        <h4 class="fw-bold text-primary mb-3">
                            ¬øNecesitas ayuda adicional?
                        </h4>
                        <p class="text-muted mb-4 fs-5">Nuestro equipo est√° disponible para asistirte</p>
                        
                        <div class="contact-grid">
                            <div class="contact-item">
                                <i class="bi bi-telephone-fill contact-icon"></i>
                                <span class="fw-semibold">+51 975 399 303</span>
                            </div>
                            <div class="contact-item">
                                <i class="bi bi-envelope-fill contact-icon"></i>
                                <span class="fw-semibold">info@copiercompanysac.com</span>
                            </div>
                            <div class="contact-item">
                                <i class="bi bi-clock-fill contact-icon"></i>
                                <span class="fw-semibold">Lun - Vie: 8:00 - 18:00</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Scripts -->
            <script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>
            
            <script>
            <![CDATA[
                document.addEventListener('DOMContentLoaded', function() {
                    // Initialize AOS animations if available
                    if (typeof AOS !== 'undefined') {
                        AOS.init({
                            duration: 800,
                            easing: 'ease-out-cubic',
                            once: true,
                            offset: 100
                        });
                    }
                    
                    // Loading animation for service cards
                    setTimeout(() => {
                        document.querySelectorAll('.loading').forEach((el, index) => {
                            setTimeout(() => {
                                el.classList.add('loaded');
                            }, index * 100);
                        });
                    }, 500);
                    
                    // Enhanced hover effects
                    document.querySelectorAll('.service-card').forEach(card => {
                        card.addEventListener('mouseenter', function() {
                            this.style.transform = 'translateY(-8px) scale(1.02)';
                            this.style.boxShadow = '0 25px 50px -12px rgba(0, 0, 0, 0.15)';
                            this.style.borderColor = 'transparent';
                        });
                        
                        card.addEventListener('mouseleave', function() {
                            this.style.transform = 'translateY(0) scale(1)';
                            this.style.boxShadow = '0 4px 6px -1px rgba(0, 0, 0, 0.1)';
                            this.style.borderColor = '#e2e8f0';
                        });
                    });
                    
                    // Smooth scroll for better UX
                    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                        anchor.addEventListener('click', function (e) {
                            e.preventDefault();
                            const target = document.querySelector(this.getAttribute('href'));
                            if (target) {
                                target.scrollIntoView({
                                    behavior: 'smooth',
                                    block: 'start'
                                });
                            }
                        });
                    });
                    
                    // Performance optimization: Intersection Observer for animations
                    const observerOptions = {
                        threshold: 0.1,
                        rootMargin: '0px 0px -50px 0px'
                    };
                    
                    const observer = new IntersectionObserver(function(entries) {
                        entries.forEach(entry => {
                            if (entry.isIntersecting) {
                                entry.target.style.opacity = '1';
                                entry.target.style.transform = 'translateY(0)';
                                entry.target.classList.add('animate-fadeInUp');
                            }
                        });
                    }, observerOptions);
                    
                    // Observe elements for lazy animation
                    document.querySelectorAll('.info-card, .contact-item').forEach(el => {
                        observer.observe(el);
                    });
                    
                    // Add dynamic background patterns
                    function addBackgroundAnimation() {
                        const heroSection = document.querySelector('.hero-section');
                        if (heroSection) {
                            setInterval(() => {
                                heroSection.style.backgroundPosition = Math.random() * 100 + 'px ' + Math.random() * 100 + 'px';
                            }, 3000);
                        }
                    }
                    
                    addBackgroundAnimation();
                    
                    // Console log for debugging
                    console.log('üöÄ Portal de equipos modernizado cargado exitosamente');
                    console.log('üì± Responsive design activado');
                    console.log('‚ú® Animaciones inicializadas');
                    console.log('üé® Bootstrap Icons cargados');
                });
            ]]>
            </script>
        </div>
    </t>
</template>
    <!-- FORMULARIO DE ASISTENCIA REMOTA -->
<template id="portal_remote_assistance" name="Remote Assistance Request Form">
    <t t-call="website.layout">
        <div id="wrap">
            <style>
                @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&amp;display=swap');
                @import url('https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css');
                
                * { font-family: 'Inter', sans-serif; }
                
                .hero-gradient {
                    background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
                    color: white;
                    position: relative;
                    overflow: hidden;
                }
                
                .hero-gradient::before {
                    content: '';
                    position: absolute;
                    top: 0;
                    left: 0;
                    right: 0;
                    bottom: 0;
                    background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 100" fill="white" opacity="0.1"><polygon points="1000,100 1000,0 0,100"/></svg>');
                }
                
                .form-card {
                    background: white;
                    border-radius: 20px;
                    box-shadow: 0 25px 50px rgba(0,0,0,0.1);
                    margin: -80px auto 40px;
                    position: relative;
                    z-index: 10;
                    border: 1px solid rgba(255,255,255,0.2);
                }
                
                .form-section {
                    border-left: 4px solid #4ecdc4;
                    background: #f8fafc;
                    border-radius: 0 12px 12px 0;
                    padding: 20px;
                    margin-bottom: 25px;
                }
                
                .form-floating label {
                    color: #64748b;
                }
                
                .form-control:focus {
                    border-color: #4ecdc4;
                    box-shadow: 0 0 0 0.2rem rgba(78, 205, 196, 0.25);
                }
                
                .btn-remote {
                    background: linear-gradient(135deg, #4ecdc4, #44a08d);
                    border: none;
                    border-radius: 12px;
                    padding: 15px 30px;
                    font-weight: 600;
                    transition: all 0.3s ease;
                }
                
                .btn-remote:hover {
                    transform: translateY(-2px);
                    box-shadow: 0 10px 25px rgba(78, 205, 196, 0.3);
                }
                
                .access-fields {
                    background: #fff7ed;
                    border: 2px dashed #fed7aa;
                    border-radius: 12px;
                    padding: 20px;
                    margin: 15px 0;
                    transition: all 0.3s ease;
                }
                
                .access-fields.show {
                    background: #f0fdf4;
                    border-color: #86efac;
                }

                .alert-success {
                    background: linear-gradient(135deg, #d4edda, #c3e6cb);
                    border: 1px solid #b8dacc;
                    border-radius: 12px;
                }
                
                .alert-danger {
                    background: linear-gradient(135deg, #f8d7da, #f1b0b7);
                    border: 1px solid #f5c6cb;
                    border-radius: 12px;
                }
            </style>
            
            <!-- Hero Section -->
            <div class="hero-gradient py-5">
                <div class="container position-relative">
                    <div class="text-center py-4">
                        <i class="fa fa-desktop mb-3 animate__animated animate__bounceIn" style="font-size: 4rem; opacity: 0.9;"></i>
                        <h1 class="display-5 fw-bold mb-3 animate__animated animate__fadeInDown">
                            Asistencia Remota
                        </h1>
                        <p class="lead mb-0 animate__animated animate__fadeInUp animate__delay-1s" style="opacity: 0.9;">
                            Solicita ayuda t√©cnica especializada para tu equipo
                        </p>
                    </div>
                </div>
            </div>
            
            <div class="container">
                <div class="form-card animate__animated animate__fadeInUp">
                    <div class="card-body p-5">
                        
                        <!-- Mensajes de √©xito o error -->
                        <t t-if="success_message">
                            <div class="alert alert-success alert-dismissible fade show mb-4" role="alert">
                                <h5 class="alert-heading">
                                    <i class="fa fa-check-circle me-2"></i>¬°Solicitud Enviada!
                                </h5>
                                <t t-raw="success_message"/>
                                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                            </div>
                            
                            <!-- Resumen de la solicitud enviada -->
                            <t t-if="request_data">
                                <div class="card mb-4" style="border: 2px solid #28a745;">
                                    <div class="card-header bg-success text-white">
                                        <h6 class="mb-0">
                                            <i class="fa fa-desktop me-2"></i>
                                            Resumen de la Solicitud - <t t-esc="request_data['secuencia']"/>
                                        </h6>
                                    </div>
                                    <div class="card-body">
                                        <div class="row g-3">
                                            <div class="col-md-6">
                                                <div class="d-flex justify-content-between">
                                                    <span class="fw-semibold">Tipo de Asistencia:</span>
                                                    <span><t t-esc="request_data['assistance_type']"/></span>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="d-flex justify-content-between">
                                                    <span class="fw-semibold">Prioridad:</span>
                                                    <span><t t-esc="request_data['priority']"/></span>
                                                </div>
                                            </div>
                                            <div class="col-md-6" t-if="request_data['anydesk_id'] != 'No proporcionado'">
                                                <div class="d-flex justify-content-between">
                                                    <span class="fw-semibold">AnyDesk ID:</span>
                                                    <span><t t-esc="request_data['anydesk_id']"/></span>
                                                </div>
                                            </div>
                                            <div class="col-md-6" t-if="request_data['username'] != 'No proporcionado'">
                                                <div class="d-flex justify-content-between">
                                                    <span class="fw-semibold">Usuario:</span>
                                                    <span><t t-esc="request_data['username']"/></span>
                                                </div>
                                            </div>
                                            <div class="col-md-6" t-if="request_data['scanner_email'] != 'No proporcionado'">
                                                <div class="d-flex justify-content-between">
                                                    <span class="fw-semibold">Email Esc√°ner:</span>
                                                    <span><t t-esc="request_data['scanner_email']"/></span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </t>
                            
                            <!-- Botones de acci√≥n despu√©s del √©xito -->
                            <div class="text-center mb-4">
                                <div class="row g-3">
                                    <div class="col-md-4">
                                        <a t-attf-href="/public/equipment_menu?copier_company_id=#{equipment.id}" 
                                           class="btn btn-outline-primary w-100">
                                            <i class="fa fa-arrow-left me-2"></i>Volver al Men√∫
                                        </a>
                                    </div>
                                    <div class="col-md-4">
                                        <a t-attf-href="/public/remote_assistance?copier_company_id=#{equipment.id}" 
                                           class="btn btn-outline-success w-100">
                                            <i class="fa fa-plus me-2"></i>Nueva Solicitud
                                        </a>
                                    </div>
                                    <div class="col-md-4">
                                        <a t-attf-href="/public/helpdesk_ticket?copier_company_id=#{equipment.id}" 
                                           class="btn btn-outline-warning w-100">
                                            <i class="fa fa-wrench me-2"></i>Reportar Problema
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </t>
                        
                        <t t-if="error_message">
                            <div class="alert alert-danger alert-dismissible fade show mb-4" role="alert">
                                <h5 class="alert-heading">
                                    <i class="fa fa-exclamation-triangle me-2"></i>Error
                                </h5>
                                <t t-esc="error_message"/>
                                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                            </div>
                        </t>
                        
                        <!-- Formulario solo si no hay √©xito -->
                        <t t-if="not success_message">
                            <!-- Informaci√≥n del Equipo -->
                            <div class="form-section">
                                <h4 class="fw-bold text-primary mb-3">
                                    <i class="fa fa-server me-2"></i>
                                    Informaci√≥n del Equipo
                                </h4>
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <div class="d-flex align-items-center p-3 bg-white rounded-3 shadow-sm">
                                            <i class="fa fa-print text-primary me-3 fs-5"></i>
                                            <div>
                                                <div class="fw-semibold">Equipo</div>
                                                <div class="text-muted small" t-esc="equipment_data['name']"></div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="d-flex align-items-center p-3 bg-white rounded-3 shadow-sm">
                                            <i class="fa fa-barcode text-success me-3 fs-5"></i>
                                            <div>
                                                <div class="fw-semibold">Serie</div>
                                                <div class="text-muted small" t-esc="equipment_data['serie']"></div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="d-flex align-items-center p-3 bg-white rounded-3 shadow-sm">
                                            <i class="fa fa-building text-info me-3 fs-5"></i>
                                            <div>
                                                <div class="fw-semibold">Cliente</div>
                                                <div class="text-muted small" t-esc="equipment_data['cliente_name']"></div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="d-flex align-items-center p-3 bg-white rounded-3 shadow-sm">
                                            <i class="fa fa-map-marker-alt text-warning me-3 fs-5"></i>
                                            <div>
                                                <div class="fw-semibold">Ubicaci√≥n</div>
                                                <div class="text-muted small" t-esc="equipment_data['ubicacion']"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Formulario -->
                            <form method="post" class="needs-validation" novalidate="true">
                                <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                                <input type="hidden" name="equipment_id" t-att-value="equipment.id"/>
                                
                                <!-- Informaci√≥n de Contacto -->
                                <div class="form-section">
                                    <h4 class="fw-bold text-success mb-3">
                                        <i class="fa fa-user-circle me-2"></i>
                                        Informaci√≥n del Solicitante
                                    </h4>
                                    <div class="row g-3">
                                        <div class="col-md-6">
                                            <div class="form-floating">
                                                <input type="text" class="form-control" id="contact_name" name="contact_name" 
                                                       placeholder="Ingresa tu nombre completo" required="true"/>
                                                <label for="contact_name">Nombre completo *</label>
                                                <div class="invalid-feedback">Por favor ingresa tu nombre completo</div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-floating">
                                                <input type="email" class="form-control" id="contact_email" name="contact_email" 
                                                       placeholder="tu.email@empresa.com" required="true"/>
                                                <label for="contact_email">Email de contacto *</label>
                                                <div class="invalid-feedback">Por favor ingresa un email v√°lido</div>
                                            </div>
                                        </div>
                                        <div class="col-12">
                                            <div class="form-floating">
                                                <input type="tel" class="form-control" id="contact_phone" name="contact_phone" 
                                                       placeholder="999 999 999"/>
                                                <label for="contact_phone">Tel√©fono de contacto</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Tipo de Asistencia -->
                                <div class="form-section">
                                    <h4 class="fw-bold text-info mb-3">
                                        <i class="fa fa-cog me-2"></i>
                                        Tipo de Asistencia
                                    </h4>
                                    <div class="row g-3">
                                        <div class="col-md-6">
                                            <div class="form-floating">
                                                <select class="form-select" id="assistance_type" name="assistance_type" required="true" onchange="toggleAccessFields()">
                                                    <option value="">Selecciona el tipo de asistencia</option>
                                                    <option value="general">Asistencia General</option>
                                                    <option value="scanner_email">Configuraci√≥n Esc√°ner por Email</option>
                                                    <option value="network">Problemas de Red</option>
                                                    <option value="drivers">Instalaci√≥n de Drivers</option>
                                                    <option value="printing">Problemas de Impresi√≥n</option>
                                                    <option value="scanning">Problemas de Escaneo</option>
                                                    <option value="maintenance">Mantenimiento Preventivo</option>
                                                    <option value="other">Otro</option>
                                                </select>
                                                <label for="assistance_type">Tipo de asistencia *</label>
                                                <div class="invalid-feedback">Por favor selecciona el tipo de asistencia</div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-floating">
                                                <select class="form-select" id="priority" name="priority">
                                                    <option value="medium" selected="true">Media</option>
                                                    <option value="low">Baja</option>
                                                    <option value="high">Alta</option>
                                                    <option value="urgent">Urgente</option>
                                                </select>
                                                <label for="priority">Prioridad</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Descripci√≥n del Problema -->
                                <div class="form-section">
                                    <h4 class="fw-bold text-danger mb-3">
                                        <i class="fa fa-exclamation-circle me-2"></i>
                                        Descripci√≥n del Problema
                                    </h4>
                                    <div class="form-floating">
                                        <textarea class="form-control" id="problem_description" name="problem_description" 
                                                  required="true" placeholder="Describe detalladamente el problema..." style="height: 120px"></textarea>
                                        <label for="problem_description">Describe detalladamente el problema que est√°s experimentando *</label>
                                        <div class="invalid-feedback">Por favor describe el problema que necesitas resolver</div>
                                    </div>
                                </div>
                                
                                <!-- Datos de Acceso Remoto -->
                                <div id="access_fields" class="access-fields" style="display: none;">
                                    <h5 class="fw-bold text-warning mb-3">
                                        <i class="fa fa-key me-2"></i>
                                        Datos de Acceso Remoto
                                    </h5>
                                    <p class="text-muted mb-3">
                                        <i class="fa fa-info-circle me-1"></i>
                                        Proporciona los datos necesarios para el acceso remoto a tu equipo
                                    </p>
                                    
                                    <!-- Campos AnyDesk -->
                                    <div id="anydesk_fields">
                                        <div class="row g-3 mb-3">
                                            <div class="col-md-4">
                                                <div class="form-floating">
                                                    <input type="text" class="form-control" id="anydesk_id" name="anydesk_id" 
                                                           placeholder="123456789"/>
                                                    <label for="anydesk_id">ID de AnyDesk</label>
                                                    <div class="form-text">Ejemplo: 123 456 789</div>
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="form-floating">
                                                    <input type="text" class="form-control" id="username" name="username" 
                                                           placeholder="Usuario del equipo"/>
                                                    <label for="username">Usuario del equipo</label>
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="form-floating">
                                                    <input type="password" class="form-control" id="user_password" name="user_password" 
                                                           placeholder="Contrase√±a"/>
                                                    <label for="user_password">Contrase√±a del usuario</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Campos Email Esc√°ner -->
                                    <div id="scanner_fields" style="display: none;">
                                        <div class="alert alert-info">
                                            <i class="fa fa-envelope me-2"></i>
                                            Para configurar el esc√°ner por email, necesitamos los datos de la cuenta de correo
                                        </div>
                                        <div class="row g-3">
                                            <div class="col-md-6">
                                                <div class="form-floating">
                                                    <input type="email" class="form-control" id="scanner_email" name="scanner_email" 
                                                           placeholder="scanner@empresa.com"/>
                                                    <label for="scanner_email">Email del esc√°ner</label>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-floating">
                                                    <input type="password" class="form-control" id="scanner_password" name="scanner_password" 
                                                           placeholder="Contrase√±a del email"/>
                                                    <label for="scanner_password">Contrase√±a del email</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Botones -->
                                <div class="row g-3 mt-4">
                                    <div class="col-md-6">
                                        <a t-attf-href="/public/equipment_menu?copier_company_id=#{equipment.id}" 
                                           class="btn btn-outline-secondary w-100 py-3">
                                            <i class="fa fa-arrow-left me-2"></i>Regresar al Men√∫
                                        </a>
                                    </div>
                                    <div class="col-md-6">
                                        <button type="submit" class="btn btn-remote text-white w-100 py-3">
                                            <i class="fa fa-paper-plane me-2"></i>Solicitar Asistencia Remota
                                        </button>
                                    </div>
                                </div>
                            </form>
                        </t>
                    </div>
                </div>
                
                <!-- Informaci√≥n Adicional -->
                <div class="text-center py-4">
                    <div class="card border-0" style="background: linear-gradient(135deg, #f8fafc, #e2e8f0);">
                        <div class="card-body py-4">
                            <h5 class="fw-bold text-primary mb-3">
                                <i class="fa fa-shield-alt me-2"></i>
                                Informaci√≥n de Seguridad
                            </h5>
                            <p class="text-muted mb-0">
                                Tus datos de acceso est√°n protegidos y solo ser√°n utilizados por nuestro equipo t√©cnico 
                                para brindarte asistencia. La sesi√≥n remota ser√° supervisada y documentada.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            
            <script>
                // Validaci√≥n del formulario
                (function() {
                    'use strict';
                    window.addEventListener('load', function() {
                        var forms = document.getElementsByClassName('needs-validation');
                        var validation = Array.prototype.filter.call(forms, function(form) {
                            form.addEventListener('submit', function(event) {
                                if (form.checkValidity() === false) {
                                    event.preventDefault();
                                    event.stopPropagation();
                                }
                                form.classList.add('was-validated');
                            }, false);
                        });
                    }, false);
                })();
                
                // Mostrar/ocultar campos seg√∫n tipo de asistencia
                function toggleAccessFields() {
                    const assistanceType = document.getElementById('assistance_type').value;
                    const accessFields = document.getElementById('access_fields');
                    const anydeskFields = document.getElementById('anydesk_fields');
                    const scannerFields = document.getElementById('scanner_fields');
                    
                    if (assistanceType &amp;&amp; assistanceType !== '') {
                        accessFields.style.display = 'block';
                        accessFields.classList.add('show');
                        
                        // Mostrar campos espec√≠ficos seg√∫n el tipo
                        if (assistanceType === 'scanner_email') {
                            scannerFields.style.display = 'block';
                            anydeskFields.style.display = 'none';
                            
                            // Hacer requerido el email del esc√°ner
                            document.getElementById('scanner_email').required = true;
                        } else {
                            scannerFields.style.display = 'none';
                            anydeskFields.style.display = 'block';
                            
                            // Quitar requerimiento del email del esc√°ner
                            document.getElementById('scanner_email').required = false;
                        }
                    } else {
                        accessFields.style.display = 'none';
                        accessFields.classList.remove('show');
                    }
                }
                
                // Animaciones y efectos
                document.addEventListener('DOMContentLoaded', function() {
                    // Efecto de focus en inputs
                    const inputs = document.querySelectorAll('.form-control');
                    inputs.forEach(input =&gt; {
                        input.addEventListener('focus', function() {
                            this.parentElement.style.transform = 'scale(1.02)';
                            this.parentElement.style.transition = 'transform 0.2s ease';
                        });
                        
                        input.addEventListener('blur', function() {
                            this.parentElement.style.transform = 'scale(1)';
                        });
                    });
                });
            </script>
        </div>
    </t>
</template>
    
    <!-- FORMULARIO MEJORADO DE TICKETS -->

<!-- TEMPLATE CORREGIDO BASADO EN EL PATR√ìN QUE FUNCIONA -->
<template id="public_helpdesk_ticket_form" name="Enhanced Public Ticket Form">
    <t t-call="website.layout">
        <div id="wrap">
            <!-- CSS permanece igual -->
            <style>
                @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&amp;display=swap');
                @import url('https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css');
                
                * { font-family: 'Inter', sans-serif; }
                
                .hero-ticket {
                    background: linear-gradient(135deg, #ff6b6b 0%, #ff8e8e 100%);
                    color: white;
                    position: relative;
                    overflow: hidden;
                }
                
                .form-section-ticket {
                    border-left: 4px solid #ff6b6b;
                    background: #fff5f5;
                    border-radius: 0 12px 12px 0;
                    padding: 20px;
                    margin-bottom: 25px;
                }
                
                .problem-type-grid {
                    display: grid;
                    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
                    gap: 15px;
                    margin: 20px 0;
                }
                
                .problem-type-card {
                    border: 2px solid #e2e8f0;
                    border-radius: 12px;
                    padding: 20px;
                    text-align: center;
                    cursor: pointer;
                    transition: all 0.3s ease;
                    background: white;
                }
                
                .problem-type-card:hover {
                    border-color: #ff6b6b;
                    transform: translateY(-2px);
                    box-shadow: 0 8px 25px rgba(255, 107, 107, 0.15);
                }
                
                .problem-type-card.selected {
                    border-color: #ff6b6b;
                    background: linear-gradient(135deg, #fff5f5, #fef2f2);
                }
                
                .problem-icon {
                    width: 60px;
                    height: 60px;
                    border-radius: 50%;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    margin: 0 auto 15px;
                    font-size: 24px;
                    color: white;
                }
                
                .btn-ticket {
                    background: linear-gradient(135deg, #ff6b6b, #ff8e8e);
                    border: none;
                    border-radius: 12px;
                    padding: 15px 30px;
                    font-weight: 600;
                    transition: all 0.3s ease;
                }
                
                .btn-ticket:hover {
                    transform: translateY(-2px);
                    box-shadow: 0 10px 25px rgba(255, 107, 107, 0.3);
                }
                
                .form-card {
                    background: white;
                    border-radius: 20px;
                    box-shadow: 0 25px 50px rgba(0,0,0,0.1);
                    margin: -80px auto 40px;
                    position: relative;
                    z-index: 10;
                    border: 1px solid rgba(255,255,255,0.2);
                }
                
                .description-section {
                    display: none;
                    animation: fadeIn 0.5s ease-in;
                }
                
                .description-section.show {
                    display: block;
                }
                
                @keyframes fadeIn {
                    from { opacity: 0; transform: translateY(20px); }
                    to { opacity: 1; transform: translateY(0); }
                }
                
                .auto-description {
                    background: #f0f9ff;
                    border: 1px solid #bae6fd;
                    border-radius: 8px;
                    padding: 15px;
                    margin: 15px 0;
                }
            </style>
            
            <!-- Hero Section -->
            <div class="hero-ticket py-5">
                <div class="container position-relative">
                    <div class="text-center py-4">
                        <i class="fa fa-exclamation-triangle mb-3 animate__animated animate__bounceIn" style="font-size: 4rem; opacity: 0.9;"></i>
                        <h1 class="display-5 fw-bold mb-3 animate__animated animate__fadeInDown">
                            Reportar Problema
                        </h1>
                        <p class="lead mb-0 animate__animated animate__fadeInUp animate__delay-1s" style="opacity: 0.9;">
                            Reporta fallas t√©cnicas y problemas con tu equipo
                        </p>
                    </div>
                </div>
            </div>
            
            <div class="container">
                <div class="form-card animate__animated animate__fadeInUp">
                    <div class="card-body p-5">
                        <!-- Mensajes de √©xito/error -->
                        <t t-if="success_message">
                            <div class="alert alert-success alert-dismissible fade show position-fixed" 
                                style="top: 20px; right: 20px; z-index: 9999; max-width: 400px;" role="alert">
                                <i class="fa fa-check-circle me-2"></i>
                                <span t-esc="success_message"></span>
                                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                            </div>
                        </t>
                        
                        <t t-if="error_message">
                            <div class="alert alert-danger alert-dismissible fade show" role="alert">
                                <i class="fa fa-exclamation-triangle me-2"></i>
                                <span t-esc="error_message"></span>
                                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                            </div>
                        </t>
                        
                        <!-- Informaci√≥n del Equipo -->
                        <div class="form-section-ticket">
                            <h4 class="fw-bold text-primary mb-3">
                                <i class="fa fa-server me-2"></i>
                                Informaci√≥n del Equipo
                            </h4>
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <div class="d-flex align-items-center p-3 bg-white rounded-3 shadow-sm">
                                        <i class="fa fa-print text-primary me-3 fs-5"></i>
                                        <div>
                                            <div class="fw-semibold">Equipo</div>
                                            <div class="text-muted small">
                                                <t t-if="equipment and equipment.name">
                                                    <span t-esc="equipment.name.name"/>
                                                </t>
                                                <t t-else="">
                                                    Sin nombre
                                                </t>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="d-flex align-items-center p-3 bg-white rounded-3 shadow-sm">
                                        <i class="fa fa-barcode text-success me-3 fs-5"></i>
                                        <div>
                                            <div class="fw-semibold">Serie</div>
                                            <div class="text-muted small">
                                                <t t-if="equipment and equipment.serie_id">
                                                    <span t-esc="equipment.serie_id"/>
                                                </t>
                                                <t t-else="">
                                                    Sin serie
                                                </t>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="d-flex align-items-center p-3 bg-white rounded-3 shadow-sm">
                                        <i class="fa fa-building text-info me-3 fs-5"></i>
                                        <div>
                                            <div class="fw-semibold">Cliente</div>
                                            <div class="text-muted small">
                                                <t t-if="equipment and equipment.cliente_id">
                                                    <span t-esc="equipment.cliente_id.name"/>
                                                </t>
                                                <t t-else="">
                                                    Sin cliente
                                                </t>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="d-flex align-items-center p-3 bg-white rounded-3 shadow-sm">
                                        <i class="fa fa-map-marker-alt text-warning me-3 fs-5"></i>
                                        <div>
                                            <div class="fw-semibold">Ubicaci√≥n</div>
                                            <div class="text-muted small">
                                                <t t-if="equipment and equipment.ubicacion">
                                                    <span t-esc="equipment.ubicacion"/>
                                                </t>
                                                <t t-else="">
                                                    Sin ubicaci√≥n
                                                </t>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Formulario -->
                        <form method="post" enctype="multipart/form-data" class="needs-validation" novalidate="true">
                            <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                            <input type="hidden" name="copier_company_id" t-att-value="equipment.id"/>
                            
                            <!-- Tipo de Problema -->
                            <div class="form-section-ticket">
                                <h4 class="fw-bold text-danger mb-3">
                                    <i class="fa fa-exclamation-circle me-2"></i>
                                    ¬øQu√© tipo de problema tienes?
                                </h4>
                                
                                <div class="problem-type-grid">
                                    <div class="problem-type-card" onclick="selectProblemType('printing')">
                                        <div class="problem-icon" style="background: linear-gradient(135deg, #ff6b6b, #ff8e8e);">
                                            <i class="fa fa-print"></i>
                                        </div>
                                        <h6 class="fw-semibold">Problemas de Impresi√≥n</h6>
                                        <p class="text-muted small mb-0">No imprime, calidad deficiente, velocidad lenta</p>
                                    </div>
                                    
                                    <div class="problem-type-card" onclick="selectProblemType('scanning')">
                                        <div class="problem-icon" style="background: linear-gradient(135deg, #4ecdc4, #44a08d);">
                                            <i class="fa fa-scanner"></i>
                                        </div>
                                        <h6 class="fw-semibold">Problemas de Escaneo</h6>
                                        <p class="text-muted small mb-0">No escanea, calidad deficiente, errores</p>
                                    </div>
                                    
                                    <div class="problem-type-card" onclick="selectProblemType('paper_jam')">
                                        <div class="problem-icon" style="background: linear-gradient(135deg, #ffa726, #ff7043);">
                                            <i class="fa fa-file-alt"></i>
                                        </div>
                                        <h6 class="fw-semibold">Atasco de Papel</h6>
                                        <p class="text-muted small mb-0">Papel atascado, alimentaci√≥n incorrecta</p>
                                    </div>
                                    
                                    <div class="problem-type-card" onclick="selectProblemType('toner')">
                                        <div class="problem-icon" style="background: linear-gradient(135deg, #ab47bc, #8e24aa);">
                                            <i class="fa fa-tint"></i>
                                        </div>
                                        <h6 class="fw-semibold">Problemas de Toner</h6>
                                        <p class="text-muted small mb-0">Toner vac√≠o, calidad de impresi√≥n</p>
                                    </div>
                                    
                                    <div class="problem-type-card" onclick="selectProblemType('network')">
                                        <div class="problem-icon" style="background: linear-gradient(135deg, #42a5f5, #1e88e5);">
                                            <i class="fa fa-wifi"></i>
                                        </div>
                                        <h6 class="fw-semibold">Problemas de Red</h6>
                                        <p class="text-muted small mb-0">Conexi√≥n perdida, no detecta la red</p>
                                    </div>
                                    
                                    <div class="problem-type-card" onclick="selectProblemType('general')">
                                        <div class="problem-icon" style="background: linear-gradient(135deg, #66bb6a, #4caf50);">
                                            <i class="fa fa-cog"></i>
                                        </div>
                                        <h6 class="fw-semibold">Otro Problema</h6>
                                        <p class="text-muted small mb-0">Problema no listado anteriormente</p>
                                    </div>
                                </div>
                                
                                <input type="hidden" id="problem_type" name="problem_type" required="true"/>
                                <div class="invalid-feedback">Por favor selecciona el tipo de problema</div>
                                
                                <!-- Descripci√≥n autom√°tica -->
                                <div id="auto_description_section" class="auto-description" style="display: none;">
                                    <h6 class="fw-bold text-info mb-2">
                                        <i class="fa fa-info-circle me-2"></i>Descripci√≥n del problema:
                                    </h6>
                                    <p id="auto_description_text" class="mb-0"></p>
                                </div>
                            </div>
                            
                            <!-- Descripci√≥n adicional SOLO para "general" -->
                            <div id="description_section" class="form-section-ticket description-section">
                                <h4 class="fw-bold text-warning mb-3">
                                    <i class="fa fa-edit me-2"></i>
                                    Describe el Problema Espec√≠fico
                                </h4>
                                <div class="form-floating">
                                    <textarea class="form-control" id="additional_description" name="additional_description" 
                                              placeholder="Describe detalladamente el problema..." style="height: 120px"></textarea>
                                    <label for="additional_description">Descripci√≥n detallada del problema *</label>
                                    <div class="invalid-feedback">Por favor describe el problema espec√≠fico</div>
                                </div>
                            </div>
                            
                            <!-- Urgencia y Foto -->
                            <div class="form-section-ticket">
                                <h4 class="fw-bold text-info mb-3">
                                    <i class="fa fa-exclamation me-2"></i>
                                    Informaci√≥n Adicional
                                </h4>
                                
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <div class="form-floating">
                                            <select class="form-select" id="urgency" name="urgency" required="true">
                                                <option value="low">Baja - Puede esperar</option>
                                                <option value="medium" selected="true">Media - Normal</option>
                                                <option value="high">Alta - Urgente</option>
                                                <option value="urgent">Cr√≠tica - Muy urgente</option>
                                            </select>
                                            <label for="urgency">Nivel de Urgencia *</label>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <label for="image" class="form-label">
                                            <i class="fa fa-camera me-2"></i>Foto del problema (opcional)
                                        </label>
                                        <input type="file" class="form-control" id="image" name="image" accept="image/*"/>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Informaci√≥n de Contacto -->
                            <div class="form-section-ticket">
                                <h4 class="fw-bold text-success mb-3">
                                    <i class="fa fa-user-circle me-2"></i>
                                    Informaci√≥n de Contacto
                                </h4>
                                <p class="text-muted mb-3">
                                    <i class="fa fa-info-circle me-2"></i>
                                    Ingresa tus datos de contacto para que podamos comunicarnos contigo sobre este reporte.
                                </p>
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <div class="form-floating">
                                            <input type="text" class="form-control" id="nombre_reporta" name="nombre_reporta" 
                                                   required="true" placeholder="Nombre completo"/>
                                            <label for="nombre_reporta">Tu nombre completo *</label>
                                            <div class="invalid-feedback">Por favor ingresa tu nombre</div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-floating">
                                            <input type="email" class="form-control" id="email" name="email" 
                                                   required="true" placeholder="Email"/>
                                            <label for="email">Tu email de contacto *</label>
                                            <div class="invalid-feedback">Por favor ingresa un email v√°lido</div>
                                        </div>
                                    </div>
                                    <div class="col-12">
                                        <div class="form-floating">
                                            <input type="tel" class="form-control" id="celular_reporta" name="celular_reporta" 
                                                   required="true" placeholder="Tel√©fono"/>
                                            <label for="celular_reporta">Tu tel√©fono de contacto *</label>
                                            <div class="invalid-feedback">Por favor ingresa tu tel√©fono</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Botones -->
                            <div class="row g-3 mt-4">
                                <div class="col-md-6">
                                    <a t-attf-href="/public/equipment_menu?copier_company_id=#{equipment.id}" 
                                       class="btn btn-outline-secondary w-100 py-3">
                                        <i class="fa fa-arrow-left me-2"></i>Regresar al Men√∫
                                    </a>
                                </div>
                                <div class="col-md-6">
                                    <button type="submit" class="btn btn-ticket text-white w-100 py-3">
                                        <i class="fa fa-paper-plane me-2"></i>Enviar Reporte de Problema
                                    </button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            
            <!-- JavaScript simplificado -->
            <script>
                // Informaci√≥n del equipo disponible en JavaScript
                window.equipmentInfo = {
                    <t t-if="equipment">
                        id: '<t t-esc="equipment.id"/>',
                        name: '<t t-if="equipment.name"><t t-esc="equipment.name.name"/></t><t t-else="">Sin nombre</t>',
                        serie: '<t t-if="equipment.serie_id"><t t-esc="equipment.serie_id"/></t><t t-else="">Sin serie</t>',
                        ubicacion: '<t t-if="equipment.ubicacion"><t t-esc="equipment.ubicacion"/></t><t t-else="">Sin ubicaci√≥n</t>'
                    </t>
                    <t t-else="">
                        id: '',
                        name: 'Sin nombre',
                        serie: 'Sin serie',
                        ubicacion: 'Sin ubicaci√≥n'
                    </t>
                };
                
                console.log('Informaci√≥n del equipo disponible:', window.equipmentInfo);
                console.log('üìù Los campos de contacto est√°n en blanco para que el usuario ingrese sus propios datos');
            </script>
            
            <script>
                let selectedProblemType = '';
                
                // Descripciones autom√°ticas para cada tipo de problema
                const problemDescriptions = {
                    'printing': 'El equipo presenta problemas de impresi√≥n. Se requiere revisi√≥n t√©cnica para identificar y solucionar la falla en el sistema de impresi√≥n.',
                    'scanning': 'Se reportan problemas en la funci√≥n de escaneo del equipo. Es necesaria una revisi√≥n t√©cnica del m√≥dulo de escaneado.',
                    'paper_jam': 'El equipo presenta atascos de papel frecuentes. Se requiere revisi√≥n del sistema de alimentaci√≥n de papel y limpieza de rodillos.',
                    'toner': 'Problemas relacionados con el toner o calidad de impresi√≥n. Puede requerir reemplazo de toner o revisi√≥n del sistema de impresi√≥n.',
                    'network': 'El equipo presenta problemas de conectividad de red. Se requiere revisi√≥n de la configuraci√≥n de red y conectividad.',
                    'maintenance': 'Se solicita mantenimiento preventivo del equipo seg√∫n el plan de mantenimiento programado.',
                    'general': 'Problema general que requiere evaluaci√≥n t√©cnica espec√≠fica.'
                };
                
                function selectProblemType(type) {
                    // Remover selecci√≥n anterior
                    document.querySelectorAll('.problem-type-card').forEach(function(card) {
                        card.classList.remove('selected');
                    });
                    
                    // Agregar selecci√≥n actual
                    event.currentTarget.classList.add('selected');
                    selectedProblemType = type;
                    document.getElementById('problem_type').value = type;
                    
                    // Eliminar mensaje de error si existe
                    document.getElementById('problem_type').classList.remove('is-invalid');
                    
                    // Mostrar descripci√≥n autom√°tica
                    const autoDescSection = document.getElementById('auto_description_section');
                    const autoDescText = document.getElementById('auto_description_text');
                    const descSection = document.getElementById('description_section');
                    const additionalDescInput = document.getElementById('additional_description');
                    
                    if (problemDescriptions[type]) {
                        autoDescText.textContent = problemDescriptions[type];
                        autoDescSection.style.display = 'block';
                    }
                    
                    // Mostrar campo de descripci√≥n adicional SOLO para "general"
                    if (type === 'general') {
                        descSection.classList.add('show');
                        additionalDescInput.required = true;
                    } else {
                        descSection.classList.remove('show');
                        additionalDescInput.required = false;
                        additionalDescInput.value = '';
                    }
                }
                
                // Funci√≥n para prellenar campos de contacto
                function fillContactFields() {
                    // ‚úÖ NO PRELLENAR DATOS DE CONTACTO
                    // Los campos de contacto permanecen vac√≠os para que cualquier persona
                    // pueda reportar el problema e ingresar sus propios datos
                    
                    console.log('üìù Campos de contacto listos para que el usuario ingrese sus datos');
                    console.log('üñ®Ô∏è Informaci√≥n del equipo ya mostrada en la secci√≥n correspondiente');
                    
                    // Solo mostrar informaci√≥n del equipo disponible en consola para debugging
                    if (typeof window.equipmentInfo !== 'undefined') {
                        console.log('üìã Equipo: ' + window.equipmentInfo.name);
                        console.log('üî¢ Serie: ' + window.equipmentInfo.serie);
                        console.log('üìç Ubicaci√≥n: ' + window.equipmentInfo.ubicacion);
                    }
                }
                
                // Validaci√≥n del formulario
                (function() {
                    'use strict';
                    window.addEventListener('load', function() {
                        var forms = document.getElementsByClassName('needs-validation');
                        var validation = Array.prototype.filter.call(forms, function(form) {
                            form.addEventListener('submit', function(event) {
                                var isValid = true;
                                
                                // Validar tipo de problema
                                if (!selectedProblemType) {
                                    document.getElementById('problem_type').classList.add('is-invalid');
                                    isValid = false;
                                }
                                
                                // Validar descripci√≥n adicional para "general"
                                if (selectedProblemType === 'general') {
                                    const additionalDesc = document.getElementById('additional_description');
                                    if (!additionalDesc.value.trim()) {
                                        additionalDesc.classList.add('is-invalid');
                                        isValid = false;
                                    }
                                }
                                
                                // Validar campos requeridos
                                const requiredFields = ['nombre_reporta', 'email', 'celular_reporta'];
                                requiredFields.forEach(function(fieldId) {
                                    const field = document.getElementById(fieldId);
                                    if (!field.value.trim()) {
                                        field.classList.add('is-invalid');
                                        isValid = false;
                                    }
                                });
                                
                                // Validar email
                                const emailField = document.getElementById('email');
                                const emailPattern = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
                                if (emailField.value &amp;&amp; !emailPattern.test(emailField.value)) {
                                    emailField.classList.add('is-invalid');
                                    isValid = false;
                                }
                                
                                if (!isValid || form.checkValidity() === false) {
                                    event.preventDefault();
                                    event.stopPropagation();
                                }
                                
                                form.classList.add('was-validated');
                            }, false);
                        });
                        
                        // Prellenar campos al cargar
                        fillContactFields();
                    }, false);
                })();
                
                // Animaciones y efectos
                document.addEventListener('DOMContentLoaded', function() {
                    // Animaci√≥n de hover en tarjetas de problema
                    document.querySelectorAll('.problem-type-card').forEach(function(card) {
                        card.addEventListener('mouseenter', function() {
                            if (!this.classList.contains('selected')) {
                                this.style.transform = 'translateY(-5px) scale(1.02)';
                            }
                        });
                        
                        card.addEventListener('mouseleave', function() {
                            if (!this.classList.contains('selected')) {
                                this.style.transform = 'translateY(0) scale(1)';
                            }
                        });
                    });
                    
                    // Limpiar mensajes de error en tiempo real
                    const inputs = document.querySelectorAll('.form-control');
                    inputs.forEach(function(input) {
                        input.addEventListener('input', function() {
                            if (this.classList.contains('is-invalid') &amp;&amp; this.value.trim()) {
                                this.classList.remove('is-invalid');
                            }
                        });
                    });
                    
                    // Prellenar campos al cargar la p√°gina
                    setTimeout(fillContactFields, 100);
                    
                    console.log('Formulario de tickets cargado correctamente');
                });
                // Auto-cerrar mensaje de √©xito despu√©s de 5 segundos
                    document.addEventListener('DOMContentLoaded', function() {
                        const successAlert = document.querySelector('.alert-success');
                        if (successAlert) {
                            setTimeout(function() {
                                successAlert.style.opacity = '0';
                                setTimeout(function() {
                                    successAlert.remove();
                                }, 300);
                            }, 5000);
                        }
                    });
            </script>
            
        </div>
    </t>
</template>
    
 <!-- FORMULARIO DE SOLICITUD DE TONER -->
<template id="portal_request_toner" name="Solicitar Toner">
        <t t-call="website.layout">
            <div id="wrap">
                <style>
                    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&amp;display=swap');
                    
                    * { font-family: 'Inter', sans-serif; }
                    
                    .hero-toner {
                        background: linear-gradient(135deg, #45b7d1 0%, #96c93d 100%);
                        color: white;
                    }
                    
                    .form-card {
                        background: white;
                        border-radius: 20px;
                        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
                        margin-top: -50px;
                        position: relative;
                        z-index: 10;
                    }
                    
                    .form-section {
                        border-bottom: 1px solid #e2e8f0;
                        padding-bottom: 1.5rem;
                    }
                    
                    .form-section:last-child {
                        border-bottom: none;
                        padding-bottom: 0;
                    }
                    
                    .toner-card {
                        border: 2px solid #e2e8f0;
                        border-radius: 12px;
                        padding: 20px;
                        text-align: center;
                        cursor: pointer;
                        transition: all 0.3s ease;
                        background: white;
                        margin-bottom: 15px;
                    }
                    
                    .toner-card:hover {
                        border-color: #45b7d1;
                        transform: translateY(-2px);
                        box-shadow: 0 8px 25px rgba(69, 183, 209, 0.15);
                    }
                    
                    .toner-card.selected {
                        border-color: #45b7d1;
                        background: linear-gradient(135deg, #f0f9ff, #e0f2fe);
                    }
                    
                    .alert-success {
                        background: linear-gradient(135deg, #d4edda, #c3e6cb);
                        border: 1px solid #b8dacc;
                        border-radius: 12px;
                    }
                    
                    .alert-danger {
                        background: linear-gradient(135deg, #f8d7da, #f1b0b7);
                        border: 1px solid #f5c6cb;
                        border-radius: 12px;
                    }
                </style>
                
                <!-- Hero Section -->
                <div class="hero-toner py-5">
                    <div class="container position-relative">
                        <div class="text-center py-4">
                            <i class="fa fa-tint mb-3" style="font-size: 4rem; opacity: 0.9;"></i>
                            <h1 class="display-5 fw-bold mb-3">Solicitar Toner</h1>
                            <p class="lead mb-0" style="opacity: 0.9;">
                                Solicita reposici√≥n de toner y consumibles
                            </p>
                        </div>
                    </div>
                </div>
                
                <div class="container">
                    <div class="form-card">
                        <div class="card-body p-5">
                            
                            <!-- Mensajes de √©xito o error -->
                            <t t-if="success_message">
                                <div class="alert alert-success alert-dismissible fade show mb-4" role="alert">
                                    <h5 class="alert-heading">
                                        <i class="fa fa-check-circle me-2"></i>¬°Solicitud Enviada!
                                    </h5>
                                    <t t-raw="success_message"/>
                                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                                </div>
                                
                                <!-- Resumen de la solicitud enviada -->
                                <t t-if="request_data">
                                    <div class="card mb-4" style="border: 2px solid #28a745;">
                                        <div class="card-header bg-success text-white">
                                            <h6 class="mb-0">
                                                <i class="fa fa-tint me-2"></i>
                                                Resumen de la Solicitud - <t t-esc="request_data['secuencia']"/>
                                            </h6>
                                        </div>
                                        <div class="card-body">
                                            <div class="row g-3">
                                                <div class="col-md-6">
                                                    <div class="d-flex justify-content-between">
                                                        <span class="fw-semibold">Tipo de Toner:</span>
                                                        <span><t t-esc="request_data['toner_type']"/></span>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="d-flex justify-content-between">
                                                        <span class="fw-semibold">Cantidad:</span>
                                                        <span><t t-esc="request_data['quantity']"/></span>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="d-flex justify-content-between">
                                                        <span class="fw-semibold">Urgencia:</span>
                                                        <span><t t-esc="request_data['urgency']"/></span>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="d-flex justify-content-between">
                                                        <span class="fw-semibold">Nivel Actual:</span>
                                                        <span><t t-esc="request_data['current_level']"/></span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </t>
                                
                                <!-- Botones de acci√≥n despu√©s del √©xito -->
                                <div class="text-center mb-4">
                                    <div class="row g-3">
                                        <div class="col-md-4">
                                            <a t-attf-href="/public/equipment_menu?copier_company_id=#{equipment.id}" 
                                               class="btn btn-outline-primary w-100">
                                                <i class="fa fa-arrow-left me-2"></i>Volver al Men√∫
                                            </a>
                                        </div>
                                        <div class="col-md-4">
                                            <a t-attf-href="/public/request_toner?copier_company_id=#{equipment.id}" 
                                               class="btn btn-outline-success w-100">
                                                <i class="fa fa-plus me-2"></i>Nueva Solicitud
                                            </a>
                                        </div>
                                        <div class="col-md-4">
                                            <a t-attf-href="/public/helpdesk_ticket?copier_company_id=#{equipment.id}" 
                                               class="btn btn-outline-warning w-100">
                                                <i class="fa fa-wrench me-2"></i>Reportar Problema
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </t>
                            
                            <t t-if="error_message">
                                <div class="alert alert-danger alert-dismissible fade show mb-4" role="alert">
                                    <h5 class="alert-heading">
                                        <i class="fa fa-exclamation-triangle me-2"></i>Error
                                    </h5>
                                    <t t-esc="error_message"/>
                                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                                </div>
                            </t>
                            
                            <!-- Formulario solo si no hay √©xito -->
                            <t t-if="not success_message">
                                <form method="post" class="needs-validation" novalidate="true">
                                    <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                                    
                                    <!-- Informaci√≥n del Equipo -->
                                    <div class="form-section mb-4">
                                        <h4 class="fw-bold text-primary mb-3">
                                            <i class="fa fa-server me-2"></i>
                                            Informaci√≥n del Equipo
                                        </h4>
                                        <div class="row g-3">
                                            <div class="col-md-6">
                                                <div class="d-flex align-items-center p-3 bg-light rounded-3">
                                                    <i class="fa fa-print text-primary me-3 fs-5"></i>
                                                    <div>
                                                        <div class="fw-semibold">Equipo</div>
                                                        <div class="text-muted small" t-esc="equipment_data['name']"></div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="d-flex align-items-center p-3 bg-light rounded-3">
                                                    <i class="fa fa-barcode text-success me-3 fs-5"></i>
                                                    <div>
                                                        <div class="fw-semibold">Serie</div>
                                                        <div class="text-muted small" t-esc="equipment_data['serie']"></div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="d-flex align-items-center p-3 bg-light rounded-3">
                                                    <i class="fa fa-building text-info me-3 fs-5"></i>
                                                    <div>
                                                        <div class="fw-semibold">Cliente</div>
                                                        <div class="text-muted small" t-esc="equipment_data['cliente_name']"></div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="d-flex align-items-center p-3 bg-light rounded-3">
                                                    <i class="fa fa-map-marker text-warning me-3 fs-5"></i>
                                                    <div>
                                                        <div class="fw-semibold">Ubicaci√≥n</div>
                                                        <div class="text-muted small" t-esc="equipment_data['ubicacion']"></div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Tipo de Consumible -->
                                    <div class="form-section mb-4">
                                        <h4 class="fw-bold text-info mb-3">
                                            <i class="fa fa-list me-2"></i>
                                            ¬øQu√© necesitas?
                                        </h4>
                                        
                                        <div class="row g-3">
                                            <div class="col-md-4">
                                                <div class="toner-card" onclick="selectTonerType('black')">
                                                    <i class="fa fa-tint mb-3" style="font-size: 2rem; color: #333;"></i>
                                                    <h6 class="fw-semibold">Toner Negro</h6>
                                                    <p class="text-muted small mb-0">Cartucho de toner negro</p>
                                                </div>
                                            </div>
                                            <div class="col-md-4" t-if="equipment_data['tipo'] == 'Color'">
                                                <div class="toner-card" onclick="selectTonerType('cyan')">
                                                    <i class="fa fa-tint mb-3" style="font-size: 2rem; color: #00bcd4;"></i>
                                                    <h6 class="fw-semibold">Toner Cian</h6>
                                                    <p class="text-muted small mb-0">Cartucho de toner cian</p>
                                                </div>
                                            </div>
                                            <div class="col-md-4" t-if="equipment_data['tipo'] == 'Color'">
                                                <div class="toner-card" onclick="selectTonerType('magenta')">
                                                    <i class="fa fa-tint mb-3" style="font-size: 2rem; color: #e91e63;"></i>
                                                    <h6 class="fw-semibold">Toner Magenta</h6>
                                                    <p class="text-muted small mb-0">Cartucho de toner magenta</p>
                                                </div>
                                            </div>
                                            <div class="col-md-4" t-if="equipment_data['tipo'] == 'Color'">
                                                <div class="toner-card" onclick="selectTonerType('yellow')">
                                                    <i class="fa fa-tint mb-3" style="font-size: 2rem; color: #ffeb3b;"></i>
                                                    <h6 class="fw-semibold">Toner Amarillo</h6>
                                                    <p class="text-muted small mb-0">Cartucho de toner amarillo</p>
                                                </div>
                                            </div>
                                            <div class="col-md-4" t-if="equipment_data['tipo'] == 'Color'">
                                                <div class="toner-card" onclick="selectTonerType('complete_set')">
                                                    <i class="fa fa-palette mb-3" style="font-size: 2rem; color: #ff6b6b;"></i>
                                                    <h6 class="fw-semibold">Juego Completo</h6>
                                                    <p class="text-muted small mb-0">Todos los colores</p>
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="toner-card" onclick="selectTonerType('maintenance_kit')">
                                                    <i class="fa fa-cogs mb-3" style="font-size: 2rem; color: #45b7d1;"></i>
                                                    <h6 class="fw-semibold">Kit Mantenimiento</h6>
                                                    <p class="text-muted small mb-0">Kit de mantenimiento</p>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <input type="hidden" id="toner_type" name="toner_type" required="true"/>
                                        <div class="invalid-feedback d-block" id="toner_type_error" style="display: none !important;">
                                            Por favor selecciona el tipo de toner.
                                        </div>
                                    </div>
                                    
                                    <!-- Detalles de la Solicitud -->
                                    <div class="form-section mb-4">
                                        <h4 class="fw-bold text-warning mb-3">
                                            <i class="fa fa-info-circle me-2"></i>
                                            Detalles de la Solicitud
                                        </h4>
                                        <div class="row g-3">
                                            <div class="col-md-6">
                                                <div class="form-floating">
                                                    <select class="form-select" id="quantity" name="quantity" required="true">
                                                        <option value="1" selected="true">1 unidad</option>
                                                        <option value="2">2 unidades</option>
                                                        <option value="3">3 unidades</option>
                                                        <option value="4">4 unidades</option>
                                                        <option value="5">5 unidades</option>
                                                    </select>
                                                    <label for="quantity">Cantidad *</label>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-floating">
                                                    <select class="form-select" id="urgency" name="urgency">
                                                        <option value="low">Baja</option>
                                                        <option value="medium" selected="true">Media</option>
                                                        <option value="high">Alta</option>
                                                        <option value="urgent">Urgente</option>
                                                    </select>
                                                    <label for="urgency">Urgencia</label>
                                                </div>
                                            </div>
                                            <div class="col-12">
                                                <div class="form-floating">
                                                    <select class="form-select" id="current_toner_level" name="current_toner_level">
                                                        <option value="">No especificado</option>
                                                        <option value="empty">Vac√≠o (0%)</option>
                                                        <option value="low">Bajo (1-10%)</option>
                                                        <option value="medium_low">Medio-Bajo (11-25%)</option>
                                                        <option value="medium">Medio (26-50%)</option>
                                                        <option value="high">Alto (51-75%)</option>
                                                        <option value="full">Lleno (76-100%)</option>
                                                    </select>
                                                    <label for="current_toner_level">Nivel actual del toner</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Informaci√≥n de Contacto -->
                                    <div class="form-section mb-4">
                                        <h4 class="fw-bold text-success mb-3">
                                            <i class="fa fa-user me-2"></i>
                                            Datos del Solicitante
                                        </h4>
                                        <div class="row g-3">
                                            <div class="col-md-6">
                                                <div class="form-floating">
                                                    <input type="text" class="form-control" id="client_name" name="client_name" 
                                                           placeholder="Ingresa tu nombre completo" required="true"/>
                                                    <label for="client_name">Nombre completo *</label>
                                                    <div class="invalid-feedback">
                                                        Por favor ingresa tu nombre completo.
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-floating">
                                                    <input type="email" class="form-control" id="client_email" name="client_email" 
                                                           placeholder="tu.email@empresa.com" required="true"/>
                                                    <label for="client_email">Email *</label>
                                                    <div class="invalid-feedback">
                                                        Por favor ingresa un email v√°lido.
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-12">
                                                <div class="form-floating">
                                                    <input type="tel" class="form-control" id="client_phone" name="client_phone" 
                                                           placeholder="999 999 999"/>
                                                    <label for="client_phone">Tel√©fono</label>
                                                </div>
                                            </div>
                                            <div class="col-12">
                                                <div class="form-floating">
                                                    <textarea class="form-control" id="reason" name="reason" style="height: 100px" 
                                                              placeholder="Motivo de la solicitud..."></textarea>
                                                    <label for="reason">Motivo de la solicitud (opcional)</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Botones -->
                                    <div class="row g-3">
                                        <div class="col-md-6">
                                            <a t-attf-href="/public/equipment_menu?copier_company_id=#{equipment.id}" 
                                               class="btn btn-outline-secondary w-100 py-3">
                                                <i class="fa fa-arrow-left me-2"></i>Regresar
                                            </a>
                                        </div>
                                        <div class="col-md-6">
                                            <button type="submit" class="btn w-100 py-3 text-white" 
                                                    style="background: linear-gradient(135deg, #45b7d1, #96c93d);">
                                                <i class="fa fa-paper-plane me-2"></i>Solicitar Toner
                                            </button>
                                        </div>
                                    </div>
                                </form>
                            </t>
                        </div>
                    </div>
                </div>
                
                <script>
                    let selectedTonerType = '';
                    
                    function selectTonerType(type) {
                        // Remover selecci√≥n anterior
                        document.querySelectorAll('.toner-card').forEach(card =&gt; {
                            card.classList.remove('selected');
                        });
                        
                        // Agregar selecci√≥n al elemento clickeado
                        event.currentTarget.classList.add('selected');
                        selectedTonerType = type;
                        document.getElementById('toner_type').value = type;
                        
                        // Ocultar mensaje de error si estaba visible
                        document.getElementById('toner_type_error').style.display = 'none';
                    }
                    
                    // Validaci√≥n del formulario
                    document.addEventListener('DOMContentLoaded', function() {
                        const form = document.querySelector('.needs-validation');
                        if (form) {
                            form.addEventListener('submit', function(event) {
                                // Validar que se haya seleccionado un tipo de toner
                                if (!selectedTonerType) {
                                    event.preventDefault();
                                    event.stopPropagation();
                                    document.getElementById('toner_type_error').style.display = 'block';
                                    
                                    // Scroll hasta la secci√≥n de tipos de toner
                                    document.querySelector('#toner_type_error').scrollIntoView({
                                        behavior: 'smooth',
                                        block: 'center'
                                    });
                                    
                                    return false;
                                }
                                
                                // Validaci√≥n HTML5 nativa
                                if (!form.checkValidity()) {
                                    event.preventDefault();
                                    event.stopPropagation();
                                }
                                
                                form.classList.add('was-validated');
                            });
                        }
                    });
                </script>
            </div>
        </t>
    </template>
    
    <!-- FORMULARIO DE SUBIR CONTADORES -->
<template id="portal_upload_counters" name="Reportar Contadores">
        <t t-call="website.layout">
            <div id="wrap">
                <style>
                    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&amp;display=swap');
                    
                    * { font-family: 'Inter', sans-serif; }
                    
                    .hero-counters {
                        background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
                        color: white;
                    }
                    
                    .form-card {
                        background: white;
                        border-radius: 20px;
                        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
                        margin-top: -50px;
                        position: relative;
                        z-index: 10;
                    }
                    
                    .form-section {
                        border-bottom: 1px solid #e2e8f0;
                        padding-bottom: 1.5rem;
                    }
                    
                    .form-section:last-child {
                        border-bottom: none;
                        padding-bottom: 0;
                    }
                    
                    .counter-input {
                        text-align: center;
                        font-size: 1.5rem;
                        font-weight: 600;
                        border: 3px solid #e2e8f0;
                        border-radius: 12px;
                        padding: 20px;
                        transition: all 0.3s ease;
                    }
                    
                    .counter-input:focus {
                        border-color: #f093fb;
                        box-shadow: 0 0 0 0.2rem rgba(240, 147, 251, 0.25);
                        transform: scale(1.05);
                    }
                    
                    .counter-card {
                        background: linear-gradient(135deg, #fff, #f8fafc);
                        border: 2px solid #e2e8f0;
                        border-radius: 16px;
                        padding: 25px;
                        text-align: center;
                        margin-bottom: 20px;
                        transition: all 0.3s ease;
                    }
                    
                    .counter-card:hover {
                        transform: translateY(-2px);
                        box-shadow: 0 8px 25px rgba(0,0,0,0.1);
                    }
                    
                    .previous-counter {
                        background: linear-gradient(135deg, #e3f2fd, #bbdefb);
                        border: 1px solid #90caf9;
                        border-radius: 8px;
                        padding: 10px;
                        margin-bottom: 15px;
                    }
                    
                    .alert-success {
                        background: linear-gradient(135deg, #d4edda, #c3e6cb);
                        border: 1px solid #b8dacc;
                        border-radius: 12px;
                    }
                    
                    .alert-danger {
                        background: linear-gradient(135deg, #f8d7da, #f1b0b7);
                        border: 1px solid #f5c6cb;
                        border-radius: 12px;
                    }
                    
                    .photo-upload {
                        border: 2px dashed #e2e8f0;
                        border-radius: 12px;
                        padding: 20px;
                        text-align: center;
                        transition: all 0.3s ease;
                        cursor: pointer;
                    }
                    
                    .photo-upload:hover {
                        border-color: #f093fb;
                        background-color: #fafafa;
                    }
                </style>
                
                <!-- Hero Section -->
                <div class="hero-counters py-5">
                    <div class="container position-relative">
                        <div class="text-center py-4">
                            <i class="fa fa-chart-bar mb-3" style="font-size: 4rem; opacity: 0.9;"></i>
                            <h1 class="display-5 fw-bold mb-3">Reportar Contadores</h1>
                            <p class="lead mb-0" style="opacity: 0.9;">
                                Env√≠a las lecturas mensuales de tu equipo
                            </p>
                        </div>
                    </div>
                </div>
                
                <div class="container">
                    <div class="form-card">
                        <div class="card-body p-5">
                            
                            <!-- Mensajes de √©xito o error -->
                            <t t-if="success_message">
                                <div class="alert alert-success alert-dismissible fade show mb-4" role="alert">
                                    <h5 class="alert-heading">
                                        <i class="fa fa-check-circle me-2"></i>¬°Contadores Enviados!
                                    </h5>
                                    <t t-raw="success_message"/>
                                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                                </div>
                                
                                <!-- Resumen del reporte enviado -->
                                <t t-if="submission_data">
                                    <div class="card mb-4" style="border: 2px solid #28a745;">
                                        <div class="card-header bg-success text-white">
                                            <h6 class="mb-0">
                                                <i class="fa fa-file-alt me-2"></i>
                                                Resumen del Reporte - <t t-esc="submission_data['secuencia']"/>
                                            </h6>
                                        </div>
                                        <div class="card-body">
                                            <div class="row g-3">
                                                <div class="col-md-6">
                                                    <div class="d-flex justify-content-between">
                                                        <span class="fw-semibold">Contador B/N:</span>
                                                        <span><t t-esc="'{:,}'.format(submission_data['counter_bn'])"/></span>
                                                    </div>
                                                </div>
                                                <div class="col-md-6" t-if="equipment_data['tipo'] == 'Color'">
                                                    <div class="d-flex justify-content-between">
                                                        <span class="fw-semibold">Contador Color:</span>
                                                        <span><t t-esc="'{:,}'.format(submission_data['counter_color'])"/></span>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="d-flex justify-content-between">
                                                        <span class="fw-semibold">Copias B/N per√≠odo:</span>
                                                        <span><t t-esc="'{:,}'.format(submission_data['copies_bn_period'])"/></span>
                                                    </div>
                                                </div>
                                                <div class="col-md-6" t-if="equipment_data['tipo'] == 'Color'">
                                                    <div class="d-flex justify-content-between">
                                                        <span class="fw-semibold">Copias Color per√≠odo:</span>
                                                        <span><t t-esc="'{:,}'.format(submission_data['copies_color_period'])"/></span>
                                                    </div>
                                                </div>
                                                <div class="col-12">
                                                    <hr/>
                                                    <div class="d-flex justify-content-between fs-5 fw-bold">
                                                        <span>Total copias per√≠odo:</span>
                                                        <span class="text-primary"><t t-esc="'{:,}'.format(submission_data['total_copies_period'])"/></span>
                                                    </div>
                                                    <div class="d-flex justify-content-between fs-6 text-muted">
                                                        <span>Monto estimado:</span>
                                                        <span>S/ <t t-esc="'{:,.2f}'.format(submission_data['estimated_amount'])"/></span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </t>
                                
                                <!-- Botones de acci√≥n despu√©s del √©xito -->
                                <div class="text-center mb-4">
                                    <div class="row g-3">
                                        <div class="col-md-4">
                                            <a t-attf-href="/public/equipment_menu?copier_company_id=#{equipment.id}" 
                                               class="btn btn-outline-primary w-100">
                                                <i class="fa fa-arrow-left me-2"></i>Volver al Men√∫
                                            </a>
                                        </div>
                                        <div class="col-md-4">
                                            <a t-attf-href="/public/upload_counters?copier_company_id=#{equipment.id}" 
                                               class="btn btn-outline-success w-100">
                                                <i class="fa fa-plus me-2"></i>Nuevo Reporte
                                            </a>
                                        </div>
                                        <div class="col-md-4">
                                            <a t-attf-href="/public/helpdesk_ticket?copier_company_id=#{equipment.id}" 
                                               class="btn btn-outline-warning w-100">
                                                <i class="fa fa-wrench me-2"></i>Reportar Problema
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </t>
                            
                            <t t-if="error_message">
                                <div class="alert alert-danger alert-dismissible fade show mb-4" role="alert">
                                    <h5 class="alert-heading">
                                        <i class="fa fa-exclamation-triangle me-2"></i>Error
                                    </h5>
                                    <t t-esc="error_message"/>
                                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                                </div>
                            </t>
                            
                            <!-- Formulario solo si no hay √©xito -->
                            <t t-if="not success_message">
                                <form method="post" enctype="multipart/form-data" class="needs-validation" novalidate="true">
                                    <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                                    
                                    <!-- Informaci√≥n del Equipo -->
                                    <div class="form-section mb-4">
                                        <h4 class="fw-bold text-primary mb-3">
                                            <i class="fa fa-server me-2"></i>
                                            Informaci√≥n del Equipo
                                        </h4>
                                        <div class="row g-3">
                                            <div class="col-md-6">
                                                <div class="d-flex align-items-center p-3 bg-light rounded-3">
                                                    <i class="fa fa-print text-primary me-3 fs-5"></i>
                                                    <div>
                                                        <div class="fw-semibold">Equipo</div>
                                                        <div class="text-muted small" t-esc="equipment_data['name']"></div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="d-flex align-items-center p-3 bg-light rounded-3">
                                                    <i class="fa fa-barcode text-success me-3 fs-5"></i>
                                                    <div>
                                                        <div class="fw-semibold">Serie</div>
                                                        <div class="text-muted small" t-esc="equipment_data['serie']"></div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="d-flex align-items-center p-3 bg-light rounded-3">
                                                    <i class="fa fa-building text-info me-3 fs-5"></i>
                                                    <div>
                                                        <div class="fw-semibold">Cliente</div>
                                                        <div class="text-muted small" t-esc="equipment_data['cliente_name']"></div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="d-flex align-items-center p-3 bg-light rounded-3">
                                                    <i class="fa fa-map-marker text-warning me-3 fs-5"></i>
                                                    <div>
                                                        <div class="fw-semibold">Ubicaci√≥n</div>
                                                        <div class="text-muted small" t-esc="equipment_data['ubicacion']"></div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Contadores Anteriores (si existen) -->
                                    <t t-if="last_counter_data">
                                        <div class="form-section mb-4">
                                            <h4 class="fw-bold text-info mb-3">
                                                <i class="fa fa-history me-2"></i>
                                                √öltima Lectura Registrada
                                            </h4>
                                            <div class="previous-counter">
                                                <div class="row g-3 text-center">
                                                    <div t-att-class="'col-md-3' if equipment_data['tipo'] == 'Color' else 'col-md-4'">
                                                        <div class="fw-semibold">Fecha</div>
                                                        <div class="text-muted" t-esc="last_counter_data['date']"></div>
                                                    </div>
                                                    <div t-att-class="'col-md-3' if equipment_data['tipo'] == 'Color' else 'col-md-4'">
                                                        <div class="fw-semibold">Contador B/N</div>
                                                        <div class="text-primary fw-bold" t-esc="'{:,}'.format(last_counter_data['counter_bn'])"></div>
                                                    </div>
                                                    <div class="col-md-3" t-if="equipment_data['tipo'] == 'Color'">
                                                        <div class="fw-semibold">Contador Color</div>
                                                        <div class="text-danger fw-bold" t-esc="'{:,}'.format(last_counter_data['counter_color'])"></div>
                                                    </div>
                                                    <div t-att-class="'col-md-3' if equipment_data['tipo'] == 'Color' else 'col-md-4'">
                                                        <div class="fw-semibold">Total Copias</div>
                                                        <div class="text-success fw-bold">
                                                            <t t-if="equipment_data['tipo'] == 'Color'">
                                                                <t t-esc="'{:,}'.format(last_counter_data['copies_bn'] + last_counter_data['copies_color'])"/>
                                                            </t>
                                                            <t t-else="">
                                                                <t t-esc="'{:,}'.format(last_counter_data['copies_bn'])"/>
                                                            </t>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </t>
                                    
                                    <!-- Contadores Actuales -->
                                    <div class="form-section mb-4">
                                        <h4 class="fw-bold text-info mb-3">
                                            <i class="fa fa-tachometer-alt me-2"></i>
                                            Lecturas Actuales de Contadores
                                        </h4>
                                        
                                        <div class="row g-4">
                                            <!-- Contador B/N - Siempre visible -->
                                            <div t-att-class="'col-md-6' if equipment_data['tipo'] == 'Color' else 'col-md-12'">
                                                <div class="counter-card">
                                                    <i class="fa fa-print mb-3" style="font-size: 2.5rem; color: #333;"></i>
                                                    <h5 class="fw-bold mb-3">Contador Blanco y Negro</h5>
                                                    <t t-if="last_counter_data">
                                                        <div class="small text-muted mb-2">
                                                            √öltimo: <span class="fw-semibold" t-esc="'{:,}'.format(last_counter_data['counter_bn'])"></span>
                                                        </div>
                                                    </t>
                                                    <input type="number" class="form-control counter-input" 
                                                           id="counter_bn" name="counter_bn" required="true" 
                                                           placeholder="0" min="0" 
                                                           t-att-min="last_counter_data['counter_bn'] if last_counter_data else 0"/>
                                                    <div class="invalid-feedback">Ingresa el contador B/N actual</div>
                                                    <small class="text-muted mt-2 d-block">Total acumulado de copias en blanco y negro</small>
                                                </div>
                                            </div>
                                            
                                            <!-- Contador Color - Solo si es equipo color -->
                                            <div class="col-md-6" t-if="equipment_data['tipo'] == 'Color'">
                                                <div class="counter-card">
                                                    <i class="fa fa-palette mb-3" style="font-size: 2.5rem; color: #ff6b6b;"></i>
                                                    <h5 class="fw-bold mb-3">Contador Color</h5>
                                                    <t t-if="last_counter_data">
                                                        <div class="small text-muted mb-2">
                                                            √öltimo: <span class="fw-semibold" t-esc="'{:,}'.format(last_counter_data['counter_color'])"></span>
                                                        </div>
                                                    </t>
                                                    <input type="number" class="form-control counter-input" 
                                                           id="counter_color" name="counter_color" 
                                                           placeholder="0" min="0" value="0"
                                                           t-att-min="last_counter_data['counter_color'] if last_counter_data else 0"/>
                                                    <small class="text-muted mt-2 d-block">Total acumulado de copias a color</small>
                                                </div>
                                            </div>
                                            
                                            <!-- Campo oculto para color si es equipo monocromo -->
                                            <input type="hidden" name="counter_color" value="0" t-if="equipment_data['tipo'] != 'Color'"/>
                                        </div>
                                    </div>
                                    
                                    <!-- Informaci√≥n de Contacto -->
                                    <div class="form-section mb-4">
                                        <h4 class="fw-bold text-success mb-3">
                                            <i class="fa fa-user me-2"></i>
                                            Datos del Reportante
                                        </h4>
                                        <div class="row g-3">
                                            <div class="col-md-6">
                                                <div class="form-floating">
                                                    <input type="text" class="form-control" id="client_name" name="client_name" 
                                                           placeholder="Ingresa tu nombre completo" required="true"/>
                                                    <label for="client_name">Nombre completo *</label>
                                                    <div class="invalid-feedback">
                                                        Por favor ingresa tu nombre completo.
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-floating">
                                                    <input type="email" class="form-control" id="client_email" name="client_email" 
                                                           placeholder="tu.email@empresa.com" required="true"/>
                                                    <label for="client_email">Email *</label>
                                                    <div class="invalid-feedback">
                                                        Por favor ingresa un email v√°lido.
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-floating">
                                                    <input type="tel" class="form-control" id="client_phone" name="client_phone" 
                                                           placeholder="999 999 999"/>
                                                    <label for="client_phone">Tel√©fono</label>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-floating">
                                                    <textarea class="form-control" id="notes" name="notes" style="height: 100px" 
                                                              placeholder="Observaciones sobre los contadores..."></textarea>
                                                    <label for="notes">Observaciones (opcional)</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Evidencia Fotogr√°fica -->
                                    <div class="form-section mb-4">
                                        <h4 class="fw-bold text-warning mb-3">
                                            <i class="fa fa-camera me-2"></i>
                                            Evidencia Fotogr√°fica (Opcional)
                                        </h4>
                                        <div class="photo-upload" onclick="document.getElementById('counter_photo').click()">
                                            <i class="fa fa-camera mb-2" style="font-size: 2rem; color: #6c757d;"></i>
                                            <div class="fw-semibold mb-1">Subir foto del contador</div>
                                            <small class="text-muted">Haz clic aqu√≠ para seleccionar una imagen</small>
                                            <input type="file" id="counter_photo" name="counter_photo" 
                                                   accept="image/*" style="display: none;" 
                                                   onchange="showSelectedFile(this)"/>
                                            <div id="selected_file" class="mt-2 text-success fw-semibold" style="display: none;"></div>
                                        </div>
                                    </div>
                                    
                                    <!-- Botones -->
                                    <div class="row g-3">
                                        <div class="col-md-6">
                                            <a t-attf-href="/public/equipment_menu?copier_company_id=#{equipment.id}" 
                                               class="btn btn-outline-secondary w-100 py-3">
                                                <i class="fa fa-arrow-left me-2"></i>Regresar
                                            </a>
                                        </div>
                                        <div class="col-md-6">
                                            <button type="submit" class="btn w-100 py-3 text-white" 
                                                    style="background: linear-gradient(135deg, #f093fb, #f5576c);">
                                                <i class="fa fa-upload me-2"></i>Enviar Contadores
                                            </button>
                                        </div>
                                    </div>
                                </form>
                            </t>
                        </div>
                    </div>
                </div>
                
                <script>
                    function showSelectedFile(input) {
                        const fileDiv = document.getElementById('selected_file');
                        if (input.files &amp;&amp; input.files[0]) {
                            fileDiv.textContent = 'üì∑ ' + input.files[0].name;
                            fileDiv.style.display = 'block';
                        } else {
                            fileDiv.style.display = 'none';
                        }
                    }
                    
                    // Validaci√≥n del formulario
                    document.addEventListener('DOMContentLoaded', function() {
                        const form = document.querySelector('.needs-validation');
                        if (form) {
                            form.addEventListener('submit', function(event) {
                                // Validaci√≥n HTML5 nativa
                                if (!form.checkValidity()) {
                                    event.preventDefault();
                                    event.stopPropagation();
                                }
                                
                                form.classList.add('was-validated');
                            });
                        }
                        
                        // Validaci√≥n en tiempo real de contadores
                        const counterBN = document.getElementById('counter_bn');
                        const counterColor = document.getElementById('counter_color');
                        
                        if (counterBN) {
                            counterBN.addEventListener('input', function() {
                                const min = parseInt(this.getAttribute('min')) || 0;
                                const value = parseInt(this.value) || 0;
                                
                                if (value &lt; min) {
                                    this.setCustomValidity(`El contador no puede ser menor a ${min.toLocaleString()}`);
                                } else {
                                    this.setCustomValidity('');
                                }
                            });
                        }
                        
                        if (counterColor) {
                            counterColor.addEventListener('input', function() {
                                const min = parseInt(this.getAttribute('min')) || 0;
                                const value = parseInt(this.value) || 0;
                                
                                if (value &lt; min) {
                                    this.setCustomValidity(`El contador no puede ser menor a ${min.toLocaleString()}`);
                                } else {
                                    this.setCustomValidity('');
                                }
                            });
                        }
                    });
                </script>
            </div>
        </t>
    </template>
</odoo>